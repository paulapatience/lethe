<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Restart" href="restart.html" /><link rel="prev" title="Boundary Contitions - Multiphysics" href="boundary_conditions_multiphysics.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>Nitsche - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation/regular_installation.html">Regular installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/apple_arm.html">Installation on Apple ARM (M1 or M2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation/compute_canada.html">Running Lethe on Digital Research Alliance of Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../parameters.html">Parameters guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="cfd.html">General, CFD and Multiphysics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="volume_of_fluid.html">Multiphase Flow - Volume of Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="boundary_conditions_multiphysics.html">Boundary Contitions - Multiphysics</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Nitsche</a></li>
<li class="toctree-l3"><a class="reference internal" href="restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="laser_heat_source.html">Laser heat source</a></li>
<li class="toctree-l3"><a class="reference internal" href="box_refinement.html">Box refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="velocity_source.html">Velocity Source</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/floating_wall.html">Floating Wall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/floating_mesh.html">Floating Mesh (Solid Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dem/boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../unresolved_cfd-dem/void_fraction.html">Void Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unresolved_cfd-dem/cfd_dem.html">CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../rpt/rpt_parameters.html">RPT parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rpt/detector_parameters.html">Detector parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rpt/parameter_tuning.html">Parameter tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/incompressible-flow/incompressible-flow.html">Incompressible Flow</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-backward-facing-step/2d-backward-facing-step.html">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-transient-flow-around-cylinder/2d-transient-flow-around-cylinder.html">6. 2D Transient flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/3d-flow-around-sphere/flow-around-sphere.html">7. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">8. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">9. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html">10. 3D Ribbon Mixer using a Single Rotating Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/incompressible-flow/3d_nitsche_mixer_with_pbt_impeller/nitsche_mixer_with_pbt_impeller.html">11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">1. Tracer through CAD Junction in Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/rayleigh-benard-convection/rayleigh-benard-convection.html">2. Rayleigh-Bénard Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/stefan_problem/stefan_problem.html">3. Stefan problem : melting of a solid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">4. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/dam-break-VOF/dam-break-VOF.html">5. Dam break VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/rising-bubble-VOF/rising-bubble-VOF.html">6. Rising bubble VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/melting-cavity/melting-cavity.html">7. Melting Cavity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/laser-heating/laser-heating.html">8. Laser heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/multiphysics/laser-meltpool/laser-meltpool.html">9. Laser meltpool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/dem/dem.html">Discrete Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/packing-in-circle/packing-in-circle.html">1. Packing in Circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/packing-in-ball/packing-in-ball.html">2. Packing in Ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/rotating-drum/rotating-drum.html">3. Rotating Drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">4. Rotating Drum with Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/rotation-of-box/rotation-of-box.html">5. Rotation of Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/silo/silo.html">6. Silo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/3d-small-scale-rotating-drum/3d-small-scale-rotating-drum.html">7. Small Scale Rotating Drum (3D)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/dem/granular-mixer/granular-mixer.html">8. Granular Mixer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/unresolved_cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical Packed Bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/unresolved_cfd-dem/square-fluidized-bed/square-fluidized-bed.html">2. Gas-Solid Fluidized Bed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM Examples</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/resolved_cfd-dem/cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/resolved_cfd-dem/sedimentation-1-particle/sedimentation-1-particle.html">2. Sedimentation of one particle.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/resolved_cfd-dem/sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">3. Non-Newtonian flow past a sphere</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/rpt/photon-count-calculation-in-a-cylindrical-vessel/photon-count-calculation-in-a-cylindrical-vessel.html">1. Photon Count Calculation in a Cylindrical Vessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/rpt/tuning-parameters-with-nomad/tuning-parameters-with-nomad.html">2. Tuning Count Calculation Model Parameters with NOMAD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../theory/fluid_dynamics/linear_solvers.html">Linear solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../theory/dem/dem.html">Discret Element Method (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tools/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/gmsh/gmsh.html">Introduction on how to use GMSH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../referencing.html">Referencing Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="nitsche">
<h1>Nitsche<a class="headerlink" href="#nitsche" title="Permalink to this headline">¶</a></h1>
<p>These parameters are used for simulations using the Nitsche immersed boundary method. Nitsche immersed boundary method works by forcing the fluid at the location of the Gauss points of the solid triangulation in order to apply the <code class="docutils literal notranslate"><span class="pre">noslip</span></code> boundary condition within the solid object.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For further understanding about the numerical method used and advanced parameters, the interested reader is referred to this article (to be published).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Specific solvers must be used for the Nitsche solid to be accounted for:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_22</span></code>: 2D flow simulations, with a 2D solid,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_33</span></code>: 3D flow simulations, with a 3D solid,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_23</span></code>: 3D flow simulations, with a 2D solid.</p></li>
</ul>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection nitsche
  #---------------------------------------------------
  # General parameters
  #---------------------------------------------------
  set verbosity = quiet
  set number of solids = 1

  #---------------------------------------------------
  # Solid parameters
  #---------------------------------------------------
  subsection nitsche solid 0
    # Penalization term for Nitsche method
    set beta = 10

    # Solid mesh
    subsection mesh
      set type = dealii
      set grid type = hyper_ball
      set grid arguments = 0, 0 : 0.25 : true
      set initial refinement = 5
      set simplex = false
    end

    # Solid velocity
    subsection solid velocity
      # Default values in 2D
      set Function expression = 0 ; 0
      # in 3D: set Function expression = 0 ; 0 ; 0
    end

    # Center of rotation, used for torque calculation
    subsection center of rotation
      set x = 0
      set y = 0
      # in 3D: set z = 0
    end

    # Condition on the motion of particles
    set enable particles motion = false

    # Force and torque calculation on solid
    set calculate force on solid = false
    set solid force name = force_solid
    set calculate torque on solid = false
    set solid torque name = torque_solid

    # Enable stopping the simulation if Nitsche particles have been lost
    set stop if particles lost = true

    # Number of sub iterations for the motion of the particles
    set particles sub iterations = 1

    # Number of Nitsche (quadrature) points to insert in a 1D cell
    set number of quadrature points = 2
  end
end
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">verbosity</span></code>: controls if Nitsche intermediate results are printed to the terminal.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Even when <code class="docutils literal notranslate"><span class="pre">verbosity</span> <span class="pre">=</span> <span class="pre">false</span></code>, Lethe produces additional files corresponding to the Nitsche immersed boundary:</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">&lt;output-name&gt;_solid_triangulation_&lt;id&gt;.pvd</span></code>, corresponding to the mesh of the solid with index <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> ;</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">&lt;output-name&gt;_solid_particles_&lt;id&gt;.pvd</span></code>, corresponding to the discrete particles inserted at the Gauss points of the solid triangulation, for the index <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> .</p></li>
</ul>
<p>The solid particles enable the Nitsche restriction visualization, while the solid triangulation is used for animation purposes.</p>
</div>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">mixer_solid_particles_00.pvd</span></code>, corresponding to the discrete particles inserted at the Gauss points of the solid triangulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">solids</span></code>: number of Nitsche solids in the simulation.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Each solid will then correspond to a <code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">nitsche</span> <span class="pre">solid</span></code>.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">nitsche</span> <span class="pre">solid</span> <span class="pre">0</span></code>: defines a solid object, with index <code class="docutils literal notranslate"><span class="pre">0</span></code>, on which the Nitsche immersed boundary is applied. Multiple solids can be added in the same fashion (<code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">nitsche</span> <span class="pre">solid</span> <span class="pre">1</span></code> etc.).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta</span></code>: controls the intensity of the Nitsche method application in the fluid region (restriction parameter). Higher values of <code class="docutils literal notranslate"><span class="pre">beta</span></code> lead to stiffer problems but prevent the fluid from penetrating the solid.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For flows with Reynolds numbers <span class="math notranslate nohighlight">\(Re &gt; 1\)</span>, we found that setting <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">=</span> <span class="pre">10</span></code> (default value) leads to satisfactory results.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">=</span> <span class="pre">0</span></code>, the solid has no influence on the flow: this value can be used for debugging purposes.</p>
<p>In case of a static solid, <code class="docutils literal notranslate"><span class="pre">beta</span></code> parameter has to be greatly increased, up to <code class="docutils literal notranslate"><span class="pre">100</span></code> or <code class="docutils literal notranslate"><span class="pre">1000</span></code>, to prevent the fluid moving through the solid. For highly viscous flows, even higher values of <code class="docutils literal notranslate"><span class="pre">beta</span></code> could be used to compensate for the larger shear stresses acting on the immersed solid.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">mesh</span></code>: defines the solid mesh used to apply Nitsche immersed boundary. The syntax is the same as that of the mesh subsection, see <a class="reference internal" href="mesh.html"><span class="doc">Mesh</span></a> for more details.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">type</span> <span class="pre">=</span> <span class="pre">gmsh</span></code> and a simplex mesh is given, do not forget to <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">simplex</span> <span class="pre">=</span> <span class="pre">true</span></code> (default value is <code class="docutils literal notranslate"><span class="pre">false</span></code>)</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The solid mesh should have a characteristic size of the same order as the fluid dynamics mesh. Using a finer mesh will not cause any problem, but will increase the computational cost without benefits.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">solid</span> <span class="pre">velocity</span></code>: defines the velocity of the solid mesh. This velocity is defined by a <code class="docutils literal notranslate"><span class="pre">Function</span> <span class="pre">expression</span></code> and can depend on both space and time.</p></li>
</ul>
<div class="admonition-examples-of-solid-velocity-function-expression admonition">
<p class="admonition-title">Examples of solid velocity <code class="docutils literal notranslate"><span class="pre">Function</span> <span class="pre">expression</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">Function</span> <span class="pre">expression</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">;</span> <span class="pre">0</span> <span class="pre">;</span> <span class="pre">0</span></code>: 3D simulation, the solid is translating along the x-axis, with a norm of <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">Function</span> <span class="pre">expression</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">;</span> <span class="pre">-4</span></code>: 2D simulation, the solid is translating along a composition of the x and y-axes, with a norm of <span class="math notranslate nohighlight">\(\sqrt(3^2+(-4)^2) = 5\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">Function</span> <span class="pre">expression</span> <span class="pre">=</span> <span class="pre">-y</span> <span class="pre">;</span> <span class="pre">x</span></code>: 2D simulation, the solid is rotating in the anti-clockwise direction around the origin, with a tangential velocity of norm <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The unit of the solid velocity value depends on the units of the mesh: if the mesh is build with the meter as the base unit, the velocity will be in <span class="math notranslate nohighlight">\(m/s\)</span>.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">center</span> <span class="pre">of</span> <span class="pre">rotation</span></code>: <span class="math notranslate nohighlight">\((x, y)\)</span> coordinates of the center of the rotation, used for torque calculation. Default center of rotation is (0, 0). Add <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">z</span></code> for 3D simulations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">enable</span> <span class="pre">particles</span> <span class="pre">motion</span></code>: controls if the immersed boundary moves within the fluid domain.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For a rotating cylinder, the <code class="docutils literal notranslate"><span class="pre">Nitsche</span> <span class="pre">solid</span></code> rotates but the boundary location does not change. For such static boundaries, the shape does not have to move within the fluid and this option can be set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. This saves significant computational time.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">solid</span> <span class="pre">velocity</span></code> leads to a motion of the solid, use <code class="docutils literal notranslate"><span class="pre">enable</span> <span class="pre">particles</span> <span class="pre">motion</span> <span class="pre">=</span> <span class="pre">true</span></code>.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calculate</span> <span class="pre">force</span> <span class="pre">on</span> <span class="pre">solid</span></code>: controls if force calculation on the immersed geometry is enabled. If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, forces will written in the output file named <code class="docutils literal notranslate"><span class="pre">solid</span> <span class="pre">force</span> <span class="pre">name</span></code>, with the solid index automatically added at the end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculate</span> <span class="pre">torque</span> <span class="pre">on</span> <span class="pre">solid</span></code>: controls if torque calculation on the immersed geometry is enabled. If set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, torques will be written in the file in the output file named <code class="docutils literal notranslate"><span class="pre">solid</span> <span class="pre">torque</span> <span class="pre">name</span></code>, with the solid index automatically added at the end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop</span> <span class="pre">if</span> <span class="pre">particles</span> <span class="pre">lost</span></code>: controls if the simulation is stopped when Nitsche particles have been lost. If <code class="docutils literal notranslate"><span class="pre">false</span></code>, the simulation will continue.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Particle loss can happen when particles move through multiple cells during a time step. This can be caused by a big <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span></code> (see <a class="reference internal" href="simulation_control.html"><span class="doc">Simulation Control</span></a>), a high fluid <code class="docutils literal notranslate"><span class="pre">mesh</span> <span class="pre">refinement</span></code> (see <a class="reference internal" href="mesh.html"><span class="doc">Mesh</span></a>), or a high CFL. To prevent particle loss, try increasing the number of <code class="docutils literal notranslate"><span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span></code>.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span></code>: number of sub iterations for the motion of the particles.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span> <span class="pre">=</span> <span class="pre">1</span></code> (default value), there is no sub iteration: the motion of the particle is solved at each <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span></code> (see <a class="reference internal" href="simulation_control.html"><span class="doc">Simulation Control</span></a>).</p>
<p>In case of particle loss, this parameter can be increased (<code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span> <span class="pre">=</span> <span class="pre">5</span></code> is a good start value) to ensure that particles are always located efficiently as they move through the cell. This increases the computational cost, but not as much as lowering the <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span></code> (in <a class="reference internal" href="simulation_control.html"><span class="doc">Simulation Control</span></a>) would.</p>
<p>Generally, it is a good practice to have sufficient <code class="docutils literal notranslate"><span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span></code> so as to ensure that particles do not move more than half a cell during a particle sub iteration.</p>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">quadrature</span> <span class="pre">points</span></code>: number of Nitsche (quadrature) points to insert in a 1D cell. The number of inserted points will be higher for higher dimensions. Increasing this number will lead to a higher points density inside the solid.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The VOF solver is used in the example <a class="reference internal" href="../../examples/incompressible-flow/2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html"><span class="doc">2D Taylor-Couette flow using Nitsche immersed boundary</span></a>.</p>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="restart.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Restart</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="boundary_conditions_multiphysics.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Boundary Contitions - Multiphysics</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../_sources/parameters/cfd/nitsche.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>