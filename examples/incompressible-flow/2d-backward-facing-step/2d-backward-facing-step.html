<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="5. 2D Transient flow around an Ahmed body" href="../2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html" /><link rel="prev" title="3. 2D Taylor-Couette flow" href="../2d-taylor-couette-flow/2d-taylor-couette-flow.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>4. 2D Flow past a backward-facing step - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/regular_installation.html">Regular installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/apple_arm.html">Installation on Apple ARM (M1 or M2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/compute_canada.html">Running Lethe on Digital Research Alliance of Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../parameters/parameters.html">Parameters guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/cfd/cfd.html">General, CFD and Multiphysics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/volume_of_fluid.html">Multiphase Flow - Volume of Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_multiphysics.html">Boundary Contitions - Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/nitsche.html">Nitsche</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/laser_heat_source.html">Laser heat source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/box_refinement.html">Box refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/velocity_source.html">Velocity Source</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_wall.html">Floating Wall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_mesh.html">Floating Mesh (Solid Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/void_fraction.html">Void Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/cfd_dem.html">CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../parameters/resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/rpt_parameters.html">RPT parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/detector_parameters.html">Detector parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/parameter_tuning.html">Parameter tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../incompressible-flow.html">Incompressible Flow</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-transient-flow-around-cylinder/2d-transient-flow-around-cylinder.html">6. 2D Transient flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-around-sphere/flow-around-sphere.html">7. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">8. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">9. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html">10. 3D Ribbon Mixer using a Single Rotating Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d_nitsche_mixer_with_pbt_impeller/nitsche_mixer_with_pbt_impeller.html">11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">1. Tracer through CAD Junction in Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rayleigh-benard-convection/rayleigh-benard-convection.html">2. Rayleigh-Bénard Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/stefan_problem/stefan_problem.html">3. Stefan problem : melting of a solid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">4. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/dam-break-VOF/dam-break-VOF.html">5. Dam break VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rising-bubble-VOF/rising-bubble-VOF.html">6. Rising bubble VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/melting-cavity/melting-cavity.html">7. Melting Cavity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-heating/laser-heating.html">8. Laser heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-meltpool/laser-meltpool.html">9. Laser meltpool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dem/dem.html">Discrete Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-circle/packing-in-circle.html">1. Packing in Circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-ball/packing-in-ball.html">2. Packing in Ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum/rotating-drum.html">3. Rotating Drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">4. Rotating Drum with Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotation-of-box/rotation-of-box.html">5. Rotation of Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/silo/silo.html">6. Silo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/3d-small-scale-rotating-drum/3d-small-scale-rotating-drum.html">7. Small Scale Rotating Drum (3D)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/granular-mixer/granular-mixer.html">8. Granular Mixer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical Packed Bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/square-fluidized-bed/square-fluidized-bed.html">2. Gas-Solid Fluidized Bed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM Examples</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/sedimentation-1-particle/sedimentation-1-particle.html">2. Sedimentation of one particle.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">3. Non-Newtonian flow past a sphere</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/photon-count-calculation-in-a-cylindrical-vessel/photon-count-calculation-in-a-cylindrical-vessel.html">1. Photon Count Calculation in a Cylindrical Vessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/tuning-parameters-with-nomad/tuning-parameters-with-nomad.html">2. Tuning Count Calculation Model Parameters with NOMAD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/linear_solvers.html">Linear solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/dem/dem.html">Discret Element Method (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tools/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/gmsh/gmsh.html">Introduction on how to use GMSH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../referencing.html">Referencing Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="d-flow-past-a-backward-facing-step">
<h1><span class="section-number">4. </span>2D Flow past a backward-facing step<a class="headerlink" href="#d-flow-past-a-backward-facing-step" title="Permalink to this headline">¶</a></h1>
<section id="features">
<h2><span class="section-number">4.1. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Solver: <code class="docutils literal notranslate"><span class="pre">gls_navier_stokes_2d</span></code> (with Q1-Q1)</p></li>
<li><p>Steady and pseudo steady state solution</p></li>
<li><p>Comparison with benchmark solutions</p></li>
<li><p>Mesh refinement and error analysis</p></li>
</ul>
</section>
<section id="location-of-the-example">
<h2><span class="section-number">4.2. </span>Location of the example<a class="headerlink" href="#location-of-the-example" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Base case (<span class="math notranslate nohighlight">\(Re &lt; 700\)</span>): <code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/2d-backward-facing-step/Reynolds100-600</span></code></p></li>
<li><p>Higher-Reynolds case (<span class="math notranslate nohighlight">\(Re \geq 700\)</span>): <code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/2d-backward-facing-step/Reynolds700-1000</span></code></p></li>
</ul>
</section>
<section id="description-of-the-case">
<h2><span class="section-number">4.3. </span>Description of the case<a class="headerlink" href="#description-of-the-case" title="Permalink to this headline">¶</a></h2>
<p>In this example, a bidimensional flow goes past a backward-facing step. The flow enters from the left inlet and separates from the bottom wall at the step, and then reattaches to it further downstream at a distance <span class="math notranslate nohighlight">\(x_r\)</span> from the step.</p>
<img alt="../../../_images/backward_facing_step_description.png" src="../../../_images/backward_facing_step_description.png"/>
<p>The backward-facing step problem is a classical computational fluid dynamics problem. The fact that it features a non-trivial solution while maintaining simple geometry and boundary conditions makes this problem a good candidate for validation purposes as well as to test the robustness of a given CFD method. First, the basic parameters used to solve the backward-facing step problem will be exposed. A solution to several Reynolds numbers (from <span class="math notranslate nohighlight">\(Re = 100\)</span> to <span class="math notranslate nohighlight">\(Re =1000\)</span>) will then be presented and compared to experimental and numerical data. A mesh adaptation and numerical error analysis will be carried on.</p>
</section>
<section id="parameter-file">
<h2><span class="section-number">4.4. </span>Parameter File<a class="headerlink" href="#parameter-file" title="Permalink to this headline">¶</a></h2>
<p>The following subsections show the different parameters used in the simulations. While they all remain more or less the same throughout the various cases, some of them change as the Reynolds number is increased.</p>
<section id="simulation-control">
<h3><span class="section-number">4.4.1. </span>Simulation control<a class="headerlink" href="#simulation-control" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(Re &lt; 700\)</span>, the solution is stable enough to be computed in steady state by setting <code class="docutils literal notranslate"><span class="pre">method</span></code> to <code class="docutils literal notranslate"><span class="pre">steady</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection simulation control
  set method = steady
  set number mesh adapt = 10
  set output name = backward_facing_step_output
  set output frequency = 1
  set subdivision = 1
  set output boundaries = false
end
</pre></div>
</div>
<p>A mesh refinement analysis can be done with <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">number</span> <span class="pre">mesh</span> <span class="pre">adapt</span> <span class="pre">=</span> <span class="pre">10</span></code>. By starting from a very coarse mesh and by dynamically refining the mesh at least 10 times, asymptotic convergence can be clearly observed.</p>
<p>However, for <span class="math notranslate nohighlight">\(Re \geq 700\)</span>, convergence can be quite difficult to obtain while doing a steady state simulation. In fact, as the Reynolds number increases, the problem becomes progressively stiffer to a point where the <code class="docutils literal notranslate"><span class="pre">steady</span></code> solver ultimately fails. With that in mind, the case can be solved as a transient problem until the steady state solution is obtained. This can be achieved with the <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">steady_bdf</span></code> parameter.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection simulation control
  set method = steady_bdf
  set stop tolerance = 1e-6
  set time step                     = 0.005
  set adapt                         = true
  set max cfl                       = 1e6
  set adaptative time step scaling = 1.2
  set number mesh adapt = 0
  set output name = backward_facing_step_output
  set output frequency = 1
  set subdivision = 1
  set output boundaries = false
end
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">stop</span> <span class="pre">tolerance</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">adapt</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">cfl</span></code> and <code class="docutils literal notranslate"><span class="pre">adaptive</span> <span class="pre">time</span> <span class="pre">step</span> <span class="pre">scaling</span></code> are parameters that control the pseudo-steady simulation. In this case, choosing <code class="docutils literal notranslate"><span class="pre">stop</span> <span class="pre">tolerance</span> <span class="pre">=</span> <span class="pre">1e-6</span></code> ensures that the simulation reaches steady state while keeping the number of time iterations to a minimum. Moreover, one can notice a very high value for the <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">cfl</span></code>; however, since it is used with <code class="docutils literal notranslate"><span class="pre">adaptative</span> <span class="pre">time</span> <span class="pre">step</span> <span class="pre">scaling</span></code> (and since <em>Lethe</em> is an implicit solver), even a very high value of the CFL does not compromise the results.</p>
</section>
<section id="physical-properties">
<h3><span class="section-number">4.4.2. </span>Physical Properties<a class="headerlink" href="#physical-properties" title="Permalink to this headline">¶</a></h3>
<p>In this problem, the Reynolds number is defined as follows:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[Re_{D_h} = \frac{u D_h}{\nu} = \frac{2uh}{\nu}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the step height, <span class="math notranslate nohighlight">\(D_h = 2h\)</span> is the hydraulic diameter and <span class="math notranslate nohighlight">\(\nu\)</span> the kinematic viscosity.</p>
<p>In addition, unit values of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(h\)</span> are chosen in the goal of obtaining an adimensional problem.</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[Re_{D_h} = f(\nu) = \frac{2}{\nu}\]</div></div>
<p>Consequently, the physical properties are defined as follows :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection physical properties
  set number of fluids = 1
  subsection fluid 0
        set kinematic viscosity = 0.01 # Re_h=2/nu
  end
end
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">kinematic</span> <span class="pre">viscosity</span></code> is the only parameter that changes coherently with <span class="math notranslate nohighlight">\(Re\)</span> (for example, to obtain <span class="math notranslate nohighlight">\(Re = 100\)</span>, <code class="docutils literal notranslate"><span class="pre">kinematic</span> <span class="pre">viscosity</span> <span class="pre">=</span> <span class="pre">0.02</span></code> can be used as input).</p>
</div>
</section>
<section id="mesh">
<h3><span class="section-number">4.4.3. </span>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh
  set type = gmsh
  set file name = ../backward_facing_step.msh
end
</pre></div>
</div>
<p>The mesh features quadrilateral elements as well as unit step and inlet heights (<span class="math notranslate nohighlight">\(h_{in}=h=1\)</span>). In that direction, the expansion ratio has been set to <span class="math notranslate nohighlight">\(\beta=\frac{h_{out}}{h_{in}}=2\)</span> throughout the entirety of the simulations. Also, the inlet and outlet lengths should be long enough that they allow the formation of a fully developed flow. Finally, since a <code class="docutils literal notranslate"><span class="pre">gmsh</span></code> mesh file is used, the initial mesh should be as coarse as possible, since these cells cannot be coarsened with the mesh adaptation algorithm.</p>
</section>
<section id="mesh-adaptation">
<h3><span class="section-number">4.4.4. </span>Mesh Adaptation<a class="headerlink" href="#mesh-adaptation" title="Permalink to this headline">¶</a></h3>
<p>In this example, the mesh adaptation algorithm is based on the Kelly error estimator applied on the velocity variable. This strategy is suitable here, since a fine mesh is required in the vicinity of the step while a coarser mesh is acceptable far way from it.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh adaptation
  set variable = velocity
  set type = kelly
  set fraction refinement  = 0.2
end
</pre></div>
</div>
<p>For higher Reynolds number with adjoint time stepping, <code class="docutils literal notranslate"><span class="pre">frequency</span> <span class="pre">=</span> <span class="pre">5</span></code> can be added to the above parameters in order to obtain a reasonable number of elements throughout the simulation. In this particular case, the mesh would be refined at every fifth time iteration.</p>
<p>Here is an example of mesh adaptation using the Kelly error estimator for <span class="math notranslate nohighlight">\(Re = 100\)</span>:</p>
<p>Initial coarse mesh:</p>
<img alt="../../../_images/0th_mesh.png" src="../../../_images/0th_mesh.png"/>
<p>After four refinement steps:</p>
<img alt="../../../_images/4th_mesh.png" src="../../../_images/4th_mesh.png"/>
<p>After eight refinement steps:</p>
<img alt="../../../_images/8th_mesh.png" src="../../../_images/8th_mesh.png"/>
</section>
<section id="fem">
<h3><span class="section-number">4.4.5. </span>FEM<a class="headerlink" href="#fem" title="Permalink to this headline">¶</a></h3>
<p>In this example, the interpolation order has been set to one for both velocity and pressure.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection FEM
  set pressure order = 1
  set velocity order = 1
end
</pre></div>
</div>
</section>
<section id="boundary-conditions">
<h3><span class="section-number">4.4.6. </span>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>As presented in the description of the case (see figure above), three different boundary conditions (or boundary IDs) are necessary to define this particular problem.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection boundary conditions
  set number         = 2
  set time dependent = false
  subsection bc 0
        set type = noslip
  end
  subsection bc 1
        set type = function
        subsection u
          set Function expression = 1
        end
        subsection v
          set Function expression = 0
        end
        subsection w
          set Function expression = 0
        end
  end
end
</pre></div>
</div>
<p>First, <code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">bc</span> <span class="pre">0</span></code> represents a Dirichlet boundary condition (or <code class="docutils literal notranslate"><span class="pre">noslip</span></code>) at each wall where <span class="math notranslate nohighlight">\(\mathbf{u}=\mathbf{0}.\)</span> The boundary condition at the inlet is represented as a uniform unit flow such that <span class="math notranslate nohighlight">\([u,v,w] = [1,0,0]\)</span>. In that case, the parameter <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">function</span></code> is used in <code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">bc</span> <span class="pre">1</span></code>. With this parameter, <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> can be set numerically and independently. The outflow boundary condition is considered a natural boundary condition (also known as the <em>do nothing</em> boundary condition) and it is used since we can consider the outlet to be very far from the step. In fact, this condition specifies <span class="math notranslate nohighlight">\(p \rightarrow 0\)</span> or in other words, that the traction on the fluid equals zero. In <em>Lethe</em>, this particular boundary condition is automatically loaded when nothing is assigned to a specific ID  (in our case, there is none at the outlet).</p>
</section>
<section id="non-linear-solver">
<h3><span class="section-number">4.4.7. </span>Non-linear Solver<a class="headerlink" href="#non-linear-solver" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">newton</span></code> non-linear solver is used with a medium <code class="docutils literal notranslate"><span class="pre">tolerance</span></code>, since convergence can be hard to obtain for high Reynolds number.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection non-linear solver
  set verbosity               = verbose
  set tolerance               = 1e-6
  set max iterations          = 10
end
</pre></div>
</div>
</section>
<section id="linear-solver">
<h3><span class="section-number">4.4.8. </span>Linear Solver<a class="headerlink" href="#linear-solver" title="Permalink to this headline">¶</a></h3>
<p>For <span class="math notranslate nohighlight">\(Re &lt; 700\)</span>, standard parameters are suitable to achieve convergence.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection linear solver
  set verbosity               = verbose
  set method                  = gmres
  set max iters               = 10000
  set relative residual       = 1e-4
  set minimum residual        = 1e-9
  set ilu preconditioner fill = 2
  set ilu preconditioner absolute tolerance = 1e-12
  set ilu preconditioner relative tolerance = 1.00
end
</pre></div>
</div>
<p>For <span class="math notranslate nohighlight">\(Re \geq 700\)</span>, however, it is often necessary to set <code class="docutils literal notranslate"><span class="pre">ilu</span> <span class="pre">precondtionner</span> <span class="pre">fill</span> <span class="pre">=</span> <span class="pre">2</span></code> in order to save calculation time. Also, adjusting <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">krylov</span> <span class="pre">vectors</span> <span class="pre">=</span> <span class="pre">200</span></code> can help to reach convergence.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection linear solver
  set verbosity               = verbose
  set method                  = gmres
  set max iters               = 10000
  set relative residual       = 1e-4
  set minimum residual        = 1e-9
  set ilu preconditioner fill = 2
  set ilu preconditioner absolute tolerance = 1e-12
  set ilu preconditioner relative tolerance = 1.00
  set max krylov vectors = 200
end
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is important to note that the <code class="docutils literal notranslate"><span class="pre">minimum</span> <span class="pre">residual</span></code> of the linear solver is smaller than the <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> of the nonlinear solver. The reader can consult the <a class="reference external" href="https://lethe-cfd.github.io/lethe/parameters/cfd/linear_solver_control.html">Parameters Guide</a> for more information.</p>
</div>
</section>
</section>
<section id="running-the-simulations">
<h2><span class="section-number">4.5. </span>Running the Simulations<a class="headerlink" href="#running-the-simulations" title="Permalink to this headline">¶</a></h2>
<p>The simulation can be executed using the following command (assuming that the solver’s location is in your PATH environment variable):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>gls_navier_stokes_2d 2D_backward_facing_step_steady.prm
</pre></div>
</div>
<p>However, mpi can be used to lower calculation time by using several CPUs (especially useful for pseudo-steady simulations) :</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>mpirun -np j gls_navier_stokes_2d 2D_backward_facing_step_steady.prm
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">j</span></code> is the number of CPUs used for the computations.</p>
</section>
<section id="results-and-discussion">
<h2><span class="section-number">4.6. </span>Results and Discussion<a class="headerlink" href="#results-and-discussion" title="Permalink to this headline">¶</a></h2>
<section id="low-reynolds-number-re-100">
<h3><span class="section-number">4.6.1. </span>Low Reynolds Number (<span class="math notranslate nohighlight">\(Re = 100\)</span>)<a class="headerlink" href="#low-reynolds-number-re-100" title="Permalink to this headline">¶</a></h3>
<p>After opening the file <code class="docutils literal notranslate"><span class="pre">backward_facing_step_output.pvd</span></code> with Paraview, the following results are obtained.</p>
<p>For <span class="math notranslate nohighlight">\(Re = 100\)</span> :</p>
<img alt="../../../_images/Reynolds100.png" src="../../../_images/Reynolds100.png"/>
<img alt="../../../_images/Reynolds100_zoom.png" src="../../../_images/Reynolds100_zoom.png"/>
<p>It is possible to notice that there seems to be a lot of diffusion past the step. This phenomenon is coherent with what is known of the Navier-Stokes equations: the diffusivity term is inversely proportional to the Reynolds number. Most importantly, a small eddy adjacent to the step is clearly observable. It is also visually noticeable that <span class="math notranslate nohighlight">\(x_r \simeq 2.9\)</span> (<span class="math notranslate nohighlight">\(x \simeq 17.9\)</span>). With the Python module Pyvista, raw simulation data can be extracted (from the .vtu files) and this data can be used to compute <span class="math notranslate nohighlight">\(x_r\)</span> numerically. This can be calculated with the following equation.</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\left[ \frac{du}{dy} \right]_{y=0} = 0\]</div></div>
<p>which can be resolved with a bisection algorithm or with any other appropriate numerical approach. By doing this step for each successively refined mesh (10 meshes as specified by <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">number</span> <span class="pre">mesh</span> <span class="pre">adapt</span></code> in the simulation control section), a mesh refinement analysis can be achieved.</p>
<img alt="../../../_images/Reynolds100_mesh_refinement.png" src="../../../_images/Reynolds100_mesh_refinement.png"/>
<p>where the final value of <span class="math notranslate nohighlight">\(x_r\)</span> is <span class="math notranslate nohighlight">\(2.893\)</span>. We notice from the graph that convergence is obtained quite quickly. In addition, the following figure illustrates the evolution of the relative error as the number of elements increases.</p>
<img alt="../../../_images/Reynolds100_error_analysis.png" src="../../../_images/Reynolds100_error_analysis.png"/>
<p>The reference value used in the error analysis is taken from Erturk (2008).</p>
</section>
<section id="higher-reynolds-number-re-1000">
<h3><span class="section-number">4.6.2. </span>Higher Reynolds Number (<span class="math notranslate nohighlight">\(Re=1000\)</span>)<a class="headerlink" href="#higher-reynolds-number-re-1000" title="Permalink to this headline">¶</a></h3>
<p>In a similar way as we did in the last subsection, the solution for <span class="math notranslate nohighlight">\(Re = 1000\)</span> can be obtained.</p>
<p>For <span class="math notranslate nohighlight">\(Re = 1000\)</span> :</p>
<img alt="../../../_images/Reynolds1000.png" src="../../../_images/Reynolds1000.png"/>
<img alt="../../../_images/Reynolds1000_zoom.png" src="../../../_images/Reynolds1000_zoom.png"/>
<p>On the contrary of what we saw in the <span class="math notranslate nohighlight">\(Re = 100\)</span> case, it is clearly noticeable that there is much less diffusion within the flow. This is once more coherent with the theory. The same eddy as mentioned in the previous section is still present, but grows as the Reynolds number is increased. Furthermore, a second principal eddy can be seen adjacent to the top wall in the range <span class="math notranslate nohighlight">\(x \in [25,37]\)</span>. This “oscillating flow” characteristic is expected of a higher Reynolds flow such as this one. Finally, the <span class="math notranslate nohighlight">\(x_r\)</span> variable is evaluated visually at <span class="math notranslate nohighlight">\(x_r \simeq 12.5\)</span> (<span class="math notranslate nohighlight">\(x \simeq 27.5\)</span>). By using the same Python algorithm as before, we obtain <span class="math notranslate nohighlight">\(x_r = 12.637\)</span> as a precise numerical result.</p>
</section>
</section>
<section id="validation-and-comparison">
<h2><span class="section-number">4.7. </span>Validation and Comparison<a class="headerlink" href="#validation-and-comparison" title="Permalink to this headline">¶</a></h2>
<section id="reattachment-length">
<h3><span class="section-number">4.7.1. </span>Reattachment Length<a class="headerlink" href="#reattachment-length" title="Permalink to this headline">¶</a></h3>
<p>In this section, the solutions obtained with <em>Lethe</em> are compared with data that can be found in the scientific literature (Erturk (2008) <a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">[1]</a>, Armaly and al. (1983) <a class="reference external" href="https://doi.org/10.1017/S0022112083002839">[2]</a> and Velivelli and Bryden (2015) <a class="reference external" href="https://doi.org/10.1016/j.advengsoft.2014.11.006">[3]</a>). Several studies include datasets of <span class="math notranslate nohighlight">\(x_r/h = f(Re)\)</span> (reattachment length) either experimentally or numerically. The next figure illustrates some of them in comparison with <em>Lethe</em>.</p>
<img alt="../../../_images/xr_comparison.png" src="../../../_images/xr_comparison.png"/>
<p>First, the results provided by <em>Lethe</em> are identical or so to all of the three selected studies for low Reynolds numbers (<span class="math notranslate nohighlight">\(Re \leq 400\)</span>). After that point, both results form <em>Lethe</em> and from Erturk (2008) <a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">[1]</a> diverge from the experimental data of Armaly and al. (1983) <a class="reference external" href="https://doi.org/10.1017/S0022112083002839">[2]</a>. According to <a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">[1]</a>, this error is due to 3D effects that are more potent as the flow becomes more and more turbulent. Furthermore, there is also a less significant but clearly noticeable error between <em>Lethe</em> and Erturk  <a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">[1]</a>: the fact that certain tolerances have been set higher for higher Reynolds number cases might have underestimated the reattachment length. Also, first order elements have been used throughout the whole simulation process. Using second order elements for velocity, for instance, could yield better results for higher Reynolds numbers, however, at a higher computational cost. The following table illustrates the error at <span class="math notranslate nohighlight">\(Re = 600\)</span> for first and second order velocity elements.</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 32%"/>
<col style="width: 34%"/>
<col style="width: 34%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Order</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_r/h\)</span></p></th>
<th class="head"><p>Error</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Order 1</p></td>
<td><p><span class="math notranslate nohighlight">\(10.219\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1.26\)</span> %</p></td>
</tr>
<tr class="row-odd"><td><p>Order 2</p></td>
<td><p><span class="math notranslate nohighlight">\(10.250\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(0.96\)</span> %</p></td>
</tr>
<tr class="row-even"><td><p>Erturk (2008)</p></td>
<td><p><span class="math notranslate nohighlight">\(10.349\)</span></p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="velocity-distribution">
<h3><span class="section-number">4.7.2. </span>Velocity distribution<a class="headerlink" href="#velocity-distribution" title="Permalink to this headline">¶</a></h3>
<p>To validate the quality of the mesh/geometry as well, it is interesting to compare the obtained velocity distributions with analytical data. The following figures illustrate the velocity distributions at the outlet (right wall) in comparison to the analytical solution.</p>
<p>For <span class="math notranslate nohighlight">\(Re = 100\)</span>:</p>
<img alt="../../../_images/Reynolds100_poiseuille.png" src="../../../_images/Reynolds100_poiseuille.png"/>
<p>For <span class="math notranslate nohighlight">\(Re = 1000\)</span>:</p>
<img alt="../../../_images/Reynolds1000_poiseuille.png" src="../../../_images/Reynolds1000_poiseuille.png"/>
<p>For <span class="math notranslate nohighlight">\(Re = 1000\)</span>, an error in the velocity profile is visually noticeable. We can assume that the outlet is not long enough for the flow to be fully developed at its end, meaning that there is still traction on the fluid. Consequently, increasing this length is essential in order to be able to validate cases where <span class="math notranslate nohighlight">\(Re \geq 1000\)</span>.</p>
</section>
</section>
<section id="possibilities-for-extension">
<h2><span class="section-number">4.8. </span>Possibilities for extension<a class="headerlink" href="#possibilities-for-extension" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Validate with a 3D geometry/mesh</strong>: Since experimental data takes into account 3D effects, it would be interesting to compare numerical data to experimental results.</p></li>
<li><p><strong>Use second order elements for higher Reynolds simulations</strong>: Using second order elements can improve accuracy for more turbulent flows. Also, it can be very powerful in this particular example, since quadratic elements can theoretically interpolate <em>Poiseuille</em> flows with genuinely no numerical error. Consequently, the method can yield incredibly precise results while maintaining a very coarse mesh far from the step.</p></li>
<li><p><strong>Validate for even higher Reynolds numbers</strong>: Some studies compute their simulations up to <span class="math notranslate nohighlight">\(Re = 3000\)</span>. It would also be interesting to visualize the formation of more eddies further downstream of the step.</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">4.9. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">[1]</a> Erturk, E. (2008). Numerical solutions of 2-d steady incompressible flow over a backward-facing step, part i: high reynolds number solutions. Computers and Fluids, 37(6), 633–655. <a class="reference external" href="https://doi.org/10.1016/j.compfluid.2007.09.003">https://doi.org/10.1016/j.compfluid.2007.09.003</a></p>
<p><a class="reference external" href="https://doi.org/10.1017/S0022112083002839">[2]</a> Armaly, B. F., Durst, F., Pereira, J. C. F., &amp;amp; Schönung B. (1983). Experimental and theoretical investigation of backward-facing step flow. Journal of Fluid Mechanics, 127(-1), 473–473. <a class="reference external" href="https://doi.org/10.1017/S0022112083002839">https://doi.org/10.1017/S0022112083002839</a></p>
<p><a class="reference external" href="https://doi.org/10.1016/j.advengsoft.2014.11.006">[3]</a> Velivelli, A. C., &amp;amp; Bryden, K. M. (2015). Domain decomposition based coupling between the lattice boltzmann method and traditional cfd methods – part ii: numerical solution to the backward facing step flow. Advances in Engineering Software, 82(C). <a class="reference external" href="https://doi.org/10.1016/j.advengsoft.2014.11.006">https://doi.org/10.1016/j.advengsoft.2014.11.006</a></p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">5. </span>2D Transient flow around an Ahmed body</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../2d-taylor-couette-flow/2d-taylor-couette-flow.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">3. </span>2D Taylor-Couette flow</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../../_sources/examples/incompressible-flow/2d-backward-facing-step/2d-backward-facing-step.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">4. 2D Flow past a backward-facing step</a><ul>
<li><a class="reference internal" href="#features">4.1. Features</a></li>
<li><a class="reference internal" href="#location-of-the-example">4.2. Location of the example</a></li>
<li><a class="reference internal" href="#description-of-the-case">4.3. Description of the case</a></li>
<li><a class="reference internal" href="#parameter-file">4.4. Parameter File</a><ul>
<li><a class="reference internal" href="#simulation-control">4.4.1. Simulation control</a></li>
<li><a class="reference internal" href="#physical-properties">4.4.2. Physical Properties</a></li>
<li><a class="reference internal" href="#mesh">4.4.3. Mesh</a></li>
<li><a class="reference internal" href="#mesh-adaptation">4.4.4. Mesh Adaptation</a></li>
<li><a class="reference internal" href="#fem">4.4.5. FEM</a></li>
<li><a class="reference internal" href="#boundary-conditions">4.4.6. Boundary Conditions</a></li>
<li><a class="reference internal" href="#non-linear-solver">4.4.7. Non-linear Solver</a></li>
<li><a class="reference internal" href="#linear-solver">4.4.8. Linear Solver</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-simulations">4.5. Running the Simulations</a></li>
<li><a class="reference internal" href="#results-and-discussion">4.6. Results and Discussion</a><ul>
<li><a class="reference internal" href="#low-reynolds-number-re-100">4.6.1. Low Reynolds Number (<span class="math notranslate nohighlight">\(Re = 100\)</span>)</a></li>
<li><a class="reference internal" href="#higher-reynolds-number-re-1000">4.6.2. Higher Reynolds Number (<span class="math notranslate nohighlight">\(Re=1000\)</span>)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validation-and-comparison">4.7. Validation and Comparison</a><ul>
<li><a class="reference internal" href="#reattachment-length">4.7.1. Reattachment Length</a></li>
<li><a class="reference internal" href="#velocity-distribution">4.7.2. Velocity distribution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#possibilities-for-extension">4.8. Possibilities for extension</a></li>
<li><a class="reference internal" href="#references">4.9. References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>