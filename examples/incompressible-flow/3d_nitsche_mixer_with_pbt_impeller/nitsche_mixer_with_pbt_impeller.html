<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Multiphysics Examples" href="../../multiphysics/multiphysics.html" /><link rel="prev" title="10. 3D Ribbon Mixer using a Single Rotating Reference Frame" href="../3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/regular_installation.html">Regular installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/apple_arm.html">Installation on Apple ARM (M1 or M2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/digital_alliance.html">Running Lethe on Digital Research Alliance of Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../parameters/parameters.html">Parameters guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/cfd/cfd.html">General, CFD and Multiphysics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/volume_of_fluid.html">Multiphase Flow - Volume of Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_multiphysics.html">Boundary Contitions - Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/nitsche.html">Nitsche</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/laser_heat_source.html">Laser heat source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/box_refinement.html">Box refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/velocity_source.html">Velocity Source</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_wall.html">Floating Wall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_mesh.html">Floating Mesh (Solid Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/void_fraction.html">Void Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/cfd_dem.html">CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../parameters/resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/rpt_parameters.html">RPT parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/detector_parameters.html">Detector parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/parameter_tuning.html">Parameter tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/fem_reconstruction.html">FEM Reconstruction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../incompressible-flow.html">Incompressible Flow</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-backward-facing-step/2d-backward-facing-step.html">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-transient-flow-around-cylinder/2d-transient-flow-around-cylinder.html">6. 2D Transient flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-around-sphere/flow-around-sphere.html">7. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">8. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">9. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html">10. 3D Ribbon Mixer using a Single Rotating Reference Frame</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">1. Tracer through CAD Junction in Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rayleigh-benard-convection/rayleigh-benard-convection.html">2. Rayleigh-Bénard Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/stefan_problem/stefan_problem.html">3. Stefan problem : melting of a solid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">4. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/dam-break-VOF/dam-break-VOF.html">5. Dam break VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rising-bubble-VOF/rising-bubble-VOF.html">6. Rising bubble VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/melting-cavity/melting-cavity.html">7. Melting Cavity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-heating/laser-heating.html">8. Laser heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-meltpool/laser-meltpool.html">9. Laser meltpool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dem/dem.html">Discrete Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-circle/packing-in-circle.html">1. Packing in Circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-ball/packing-in-ball.html">2. Packing in Ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum/rotating-drum.html">3. Rotating Drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">4. Rotating Drum with Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotation-of-box/rotation-of-box.html">5. Rotation of Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/silo/silo.html">6. Silo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/3d-small-scale-rotating-drum/3d-small-scale-rotating-drum.html">7. Small Scale Rotating Drum (3D)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/granular-mixer/granular-mixer.html">8. Granular Mixer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical Packed Bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/square-fluidized-bed/square-fluidized-bed.html">2. Gas-Solid Fluidized Bed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM Examples</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/sedimentation-1-particle/sedimentation-1-particle.html">2. Sedimentation of one particle.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">3. Non-Newtonian flow past a sphere</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/photon-count-calculation-in-a-cylindrical-vessel/photon-count-calculation-in-a-cylindrical-vessel.html">1. Photon Count Calculation in a Cylindrical Vessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/tuning-parameters-with-nomad/tuning-parameters-with-nomad.html">2. Tuning Count Calculation Model Parameters with NOMAD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/linear_solvers.html">Linear solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/dem/dem.html">Discret Element Method (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tools/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/gmsh/gmsh.html">Introduction on how to use GMSH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../referencing.html">Referencing Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="d-mixer-with-pitched-blade-turbine-impeller-using-nitsche-immersed-boundary">
<h1><span class="section-number">11. </span>3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary<a class="headerlink" href="#d-mixer-with-pitched-blade-turbine-impeller-using-nitsche-immersed-boundary" title="Permalink to this headline">¶</a></h1>
<p>Simulation of mixing in stirred-tanks is one important industrial application which is often simulated with Lethe. Agitated vessels are widely applied in chemical engineering as product homogenizers, heat and mass transfer enhancers, and surface area maximizers in solid-fluid processes. Batch and Continuous Stirred Tank Reactors (CSTR), for example, are among the most often reactor models applied in chemical industries that can be simulated through computational fluid dynamics.</p>
<p>This example illustrates how the transient flow in a stirred-tank can be simulated by Lethe using the Nitsche Immersed Boundary (NIB) formulation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>This example is related to this article (to be published).</p>
</div>
<p><span class="raw-html"><br/></span></p>
<section id="features">
<h2><span class="section-number">11.1. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Solvers: <code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_33</span></code></p></li>
<li><p>Transient problem</p></li>
<li><p>Rotating complex solid modeled with Nitsche immersed boundary</p></li>
<li><p>Calculation of the average velocity</p></li>
</ul>
<p><span class="raw-html"><br/></span></p>
</section>
<section id="locations-of-files-used-in-the-example">
<h2><span class="section-number">11.2. </span>Locations of Files Used in the Example<a class="headerlink" href="#locations-of-files-used-in-the-example" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Parameter file: <code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/3d_nitsche_mixer_with_pbt_impeller/mixer.prm</span></code></p></li>
<li><p>Mesh file: <code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/3d_nitsche_mixer_with_pbt_impeller/pbt.msh</span></code></p></li>
<li><p>Geometry file: <code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/3d_nitsche_mixer_with_pbt_impeller/pbt.geo</span></code></p></li>
</ul>
<p><span class="raw-html"><br/></span></p>
</section>
<section id="description-of-the-case">
<h2><span class="section-number">11.3. </span>Description of the Case<a class="headerlink" href="#description-of-the-case" title="Permalink to this headline">¶</a></h2>
<p>We simulate the flow generated by a pitched blade turbine (PBT) in a stirred tank. The PBT is an axial impeller, which generates a flow pattern that amplifies axial circulation within the vessel (in opposition to radial impellers, e.g. Rushton turbines) <a class="reference external" href="https://onlinelibrary.wiley.com/doi/book/10.1002/0471451452">[1]</a>.</p>
<p>The setup that we wish to simulate is schematized in the following figure:</p>
<img alt="PBT and tank geometry" class="align-center" id="geometry" src="../../../_images/PBT_tank_3D.svg"/><p>The dimensions are listed in the following table:</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 23%"/>
<col style="width: 32%"/>
<col style="width: 45%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(D_\text{t}\)</span></p></td>
<td><p>Tank diameter</p></td>
<td><p><span class="math notranslate nohighlight">\(0.3\)</span> m</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H\)</span></p></td>
<td><p>Height of the fluid domain</p></td>
<td><p><span class="math notranslate nohighlight">\(D_\text{t}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(C_\text{i}\)</span></p></td>
<td><p>PBT off-bottom clearance</p></td>
<td><p><span class="math notranslate nohighlight">\(D_\text{t}/4\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D_\text{i}\)</span></p></td>
<td><p>PBT diameter</p></td>
<td><p><span class="math notranslate nohighlight">\(D_\text{t}/3\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(W_\text{i}\)</span></p></td>
<td><p>PBT blade width</p></td>
<td><p><span class="math notranslate nohighlight">\(D_\text{i}/5\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(T_\text{i}\)</span></p></td>
<td><p>PBT blade thickness</p></td>
<td><p><span class="math notranslate nohighlight">\(W_\text{i}/10\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\theta\)</span></p></td>
<td><p>Tilt angle of the blades</p></td>
<td><p><span class="math notranslate nohighlight">\(45^\circ\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D_\text{s}\)</span></p></td>
<td><p>Shaft diameter</p></td>
<td><p><span class="math notranslate nohighlight">\(W_\text{i}\times \cos(\theta)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(D_\text{h}\)</span></p></td>
<td><p>Hub diameter</p></td>
<td><p><span class="math notranslate nohighlight">\(1.4 \times D_\text{s}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_\text{h}\)</span></p></td>
<td><p>Hub height</p></td>
<td><p><span class="math notranslate nohighlight">\(W_\text{i} \times \sin(\theta)\)</span></p></td>
</tr>
</tbody>
</table></div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.geo</span></code> file used to generate the mesh is available in the example folder, or <a class="reference external" href="https://github.com/lethe-cfd/lethe-utils">in lethe-utils repository</a>.</p>
</div>
<p>The boundary conditions on the tank are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">noslip</span></code> on the hull and bottom wall, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">slip</span></code> on the upper wall to mimic the liquid’s free surface.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of a <code class="docutils literal notranslate"><span class="pre">slip</span></code> boundary condition is debatable. A <code class="docutils literal notranslate"><span class="pre">none</span></code> (do-nothing) boundary condition could also be used since free surfaces have constant pressure, but the slip boundary condition is generally significantly more numerically robust.</p>
</div>
<p>For this configuration, the Reynolds number is defined as:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[Re = \frac{D_\text{i}^2 N}{\nu}\]</div></div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the angular velocity in Hertz (or Rotation Per Second, RPS), here constant (<span class="math notranslate nohighlight">\(N = 1~\text{Hz}\)</span>), and <span class="math notranslate nohighlight">\(\nu\)</span> is the kinematic viscosity in <span class="math notranslate nohighlight">\(\text{m}^2/\text{s}\)</span>.</p>
<p>We investigate this case at a Reynolds number <span class="math notranslate nohighlight">\(Re=300\)</span>. This example can easily be extended to higher Reynolds number values by lowering the kinematic viscosity. It would then be necessary to increase the mesh resolution for the solution to be meaningfully accurate.</p>
<p><span class="raw-html"><br/></span></p>
</section>
<section id="parameter-file">
<h2><span class="section-number">11.4. </span>Parameter File<a class="headerlink" href="#parameter-file" title="Permalink to this headline">¶</a></h2>
<p>Except for the Nitsche immersed boundary, all other sections of the parameter file in the present case have been explained in previous examples. However, the important sections are briefly explained for completeness.</p>
<section id="simulation-control">
<h3><span class="section-number">11.4.1. </span>Simulation Control<a class="headerlink" href="#simulation-control" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../../parameters/cfd/simulation_control.html"><span class="doc">Simulation Control</span></a> subsection defines the time integration and output results:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection simulation control
  set method                  = bdf2
  set output name             = mixer
  set output path             = ./output/
  set output frequency        = 2
  set time end                = 5
  set time step               = 0.02
  set output boundaries       = true
end
</pre></div>
</div>
<p>Since the flow generated by the agitator is naturally transient, we simulate:</p>
<ul class="simple">
<li><p>a total of <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">end</span> <span class="pre">=</span> <span class="pre">5</span></code> seconds,</p></li>
<li><p>with a <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span> <span class="pre">=</span> <span class="pre">0.02</span></code> second,</p></li>
<li><p>using a second-order <code class="docutils literal notranslate"><span class="pre">bdf2</span></code> time-stepping method.</p></li>
</ul>
<p>Results are outputted:</p>
<ul class="simple">
<li><p>at every <code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">frequency</span> <span class="pre">=</span> <span class="pre">2</span></code> iterations, and</p></li>
<li><p>we set <code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">boundaries</span> <span class="pre">=</span> <span class="pre">true</span></code> to generate an auxiliary <code class="docutils literal notranslate"><span class="pre">.vtu</span></code> file that highlights the tank walls by hiding the cells of the mesh. This allows for a clearer visualization of the mixing setup.</p></li>
</ul>
</section>
<section id="physical-properties">
<h3><span class="section-number">11.4.2. </span>Physical Properties<a class="headerlink" href="#physical-properties" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../../parameters/cfd/physical_properties.html"><span class="doc">Physical Properties</span></a> subsection defines our fluid:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection physical properties
  subsection fluid 0
    set kinematic viscosity            = 0.001
  end
end
</pre></div>
</div>
<p>The kinematic viscosity is set to <span class="math notranslate nohighlight">\(0.001\)</span>. This, combined with the angular velocity of <span class="math notranslate nohighlight">\(1~\text{Hz}\)</span> and the diameter of the impeller of <span class="math notranslate nohighlight">\(0.3~\text{m}\)</span>, will allow us to simulate the vessel at <span class="math notranslate nohighlight">\(Re=300\)</span>.</p>
</section>
<section id="mesh">
<h3><span class="section-number">11.4.3. </span>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../../parameters/cfd/mesh.html"><span class="doc">Mesh</span></a> subsection specifies the computational grid:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh
    set type                 = dealii
    set grid type            = subdivided_cylinder
    set grid arguments       = 2:0.5:0.5
    set initial refinement   = 3
end
</pre></div>
</div>
<p>Thanks to our immersed boundary approach, we only need to mesh the vessel without considering the impeller. This greatly simplifies the meshing process, so that the mesh can be generated straightforwardly using the deal.II mesh generator for a subdivided cylinder, where:</p>
<ul class="simple">
<li><p>the half-height is <span class="math notranslate nohighlight">\(= 0.5\)</span>, and</p></li>
<li><p>the radius of the vessel is <span class="math notranslate nohighlight">\(= 0.5\)</span>.</p></li>
</ul>
<p>This will generate a vessel in which the axis of the impeller will be along the <span class="math notranslate nohighlight">\(x\)</span> coordinate. The bottom of the vessel will be on the <span class="math notranslate nohighlight">\(x=-0.5\)</span> plane.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For detailed explanation of the mesh generators, see the deal.ii <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridGenerator.html">GridGenerator</a>.</p>
</div>
</section>
<section id="boundary-conditions">
<h3><span class="section-number">11.4.4. </span>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html"><span class="doc">Boundary conditions - CFD</span></a> subsection establishes the constraints on different parts of the domain:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection boundary conditions
set number                  = 3
    subsection bc 0
        set id                = 0
        set type              = noslip
    end
    subsection bc 1
        set id                = 1
        set type              = noslip
    end
    subsection bc 2
        set id                = 2
        set type              = slip
    end
end
</pre></div>
</div>
<p>Three boundary conditions are considered:</p>
<ul class="simple">
<li><p>on the hull (<code class="docutils literal notranslate"><span class="pre">id=0</span></code>, lateral walls): <code class="docutils literal notranslate"><span class="pre">noslip</span></code>,</p></li>
<li><p>on the bottom wall (<code class="docutils literal notranslate"><span class="pre">id=1</span></code>): <code class="docutils literal notranslate"><span class="pre">noslip</span></code>, and</p></li>
<li><p>on the upper wall (<code class="docutils literal notranslate"><span class="pre">id=2</span></code>): <code class="docutils literal notranslate"><span class="pre">slip</span></code>.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The boundary conditions are described in the <a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html"><span class="doc">Boundary conditions - CFD</span></a> section of the documentation.</p>
</div>
</section>
<section id="nitsche-immersed-boundary-parameters">
<h3><span class="section-number">11.4.5. </span>Nitsche Immersed Boundary Parameters<a class="headerlink" href="#nitsche-immersed-boundary-parameters" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../../../parameters/cfd/nitsche.html"><span class="doc">Nitsche</span></a> subsection is used to insert the immersed geometry and control its motion.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection nitsche

  subsection nitsche solid 0
          subsection mesh
                set type                 = gmsh
                set file name            = pbt.msh
                set simplex              = true
          end
    subsection solid velocity
            set Function expression = 0 ; 1*2*pi*z ; -1*2*pi*y
    end

    set enable particles motion   = true
    set particles sub iterations  = 10
    set calculate torque on solid = true
  end

end
</pre></div>
</div>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">mesh</span></code>: controls the mesh used for the Nitsche immersed boundary, working as a regular <a class="reference internal" href="../../../parameters/cfd/mesh.html"><span class="doc">Mesh</span></a> subsection.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">gmsh</span></code>: we import a mesh file (<code class="docutils literal notranslate"><span class="pre">.msh</span></code>) of the PBT that is in the same folder as the <code class="docutils literal notranslate"><span class="pre">.prm</span></code>, with the specified <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simplex</span> <span class="pre">=</span> <span class="pre">true</span></code>: mandatory as the mesh is built with simplices (tetrahedra), to better account for the PBT geometry</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">subsection</span> <span class="pre">solid</span> <span class="pre">velocity</span></code>: specify the velocity as a rotation around the <span class="math notranslate nohighlight">\(x\)</span> axis of the meshes, centered at <span class="math notranslate nohighlight">\((0,0,0)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">solid</span> <span class="pre">velocity</span></code> specified in the <code class="docutils literal notranslate"><span class="pre">.prm</span></code> must be consistent with the axes of the GMSH mesh.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">enable</span> <span class="pre">particles</span> <span class="pre">motion</span> <span class="pre">=</span> <span class="pre">true</span></code>: mandatory as the solid is moving inside the fluid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span> <span class="pre">=</span> <span class="pre">10</span></code>: ensures that particles are always located efficiently as they move through the cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculate</span> <span class="pre">torque</span> <span class="pre">on</span> <span class="pre">solid</span> <span class="pre">=</span> <span class="pre">true</span></code>: computes torque calculation on the PBT and saves it in the file <code class="docutils literal notranslate"><span class="pre">torque_solid_00.dat</span></code>.</p></li>
</ul>
</section>
<section id="post-processing">
<h3><span class="section-number">11.4.6. </span>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h3>
<p>It is often desirable to obtain the time-averaged velocity field when simulating a transient flow. This is achieved through the <a class="reference internal" href="../../../parameters/cfd/post_processing.html"><span class="doc">Post-Processing</span></a> section. The averaging period is started after the flows start to stabilize and reach their pseudo steady-state. In this case, we assume it happens after <span class="math notranslate nohighlight">\(2~\text{sec}\)</span>. This choice is prone to error, which can be mitigated by increasing the duration of simulations and using a longer averaging interval.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection post-processing
   set calculate average velocities = true
   set initial time = 2
end
</pre></div>
</div>
</section>
<section id="mesh-adaptation-control">
<h3><span class="section-number">11.4.7. </span>Mesh Adaptation Control<a class="headerlink" href="#mesh-adaptation-control" title="Permalink to this headline">¶</a></h3>
<p>We use <a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html"><span class="doc">Mesh Adaptation Control</span></a> on the fluid velocity, so that cells are refined in cells where the fluid velocity changes the most.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># --------------------------------------------------
# Mesh Adaptation Control
#---------------------------------------------------
subsection mesh adaptation
  set type                    = kelly
  set variable                = velocity
  set fraction type           = fraction
  set max number elements     = 1200000
  set max refinement level    = 5
  set min refinement level    = 3
  set frequency               = 5
  set fraction refinement     = 0.2
end
</pre></div>
</div>
<p>Here, we refine:</p>
<ul class="simple">
<li><p>at each <code class="docutils literal notranslate"><span class="pre">frequency</span> <span class="pre">=</span> <span class="pre">5</span></code> iterations,</p></li>
<li><p>on a <code class="docutils literal notranslate"><span class="pre">fraction</span> <span class="pre">refinement</span> <span class="pre">=</span> <span class="pre">0.2</span></code> (<span class="math notranslate nohighlight">\(20\%\)</span> of the cells),</p></li>
<li><p>with <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">number</span> <span class="pre">elements</span> <span class="pre">=</span> <span class="pre">1200000</span></code> to limit the computational cost.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">refinement</span> <span class="pre">level</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">refinement</span> <span class="pre">level</span></code> are chosen in consideration of the <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">refinement</span> <span class="pre">=</span> <span class="pre">3</span></code> of the fluid mesh: the cells cannot be coarsen (as <code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">refinement</span> <span class="pre">level</span></code> = <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">refinement</span></code>), and can be refined up to two times.</p>
</section>
<section id="non-linear-solver-parameters">
<h3><span class="section-number">11.4.8. </span>Non-linear Solver Parameters<a class="headerlink" href="#non-linear-solver-parameters" title="Permalink to this headline">¶</a></h3>
<p>Since this is a transient problem, it is not highly non-linear except for the first few iterations. Thus, we use standard <a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html"><span class="doc">Non-linear Solver Control</span></a> parameters.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection non-linear solver
  set tolerance               = 1e-4
  set solver                  = inexact_newton
end
</pre></div>
</div>
<p>Because the assembly of the Nitsche restriction for the immersed boundary is relatively expensive, we reuse the Jacobian matrix as much as possible. This is accomplished by setting <code class="docutils literal notranslate"><span class="pre">solver</span> <span class="pre">=</span> <span class="pre">inexact_newton</span></code>.</p>
</section>
<section id="linear-solver-parameters">
<h3><span class="section-number">11.4.9. </span>Linear Solver Parameters<a class="headerlink" href="#linear-solver-parameters" title="Permalink to this headline">¶</a></h3>
<p>Relatively standard parameters are used for the <a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html"><span class="doc">Linear Solver Control</span></a>. From our experience, the AMG preconditioner is more robust with the Nitsche immersed boundaries than the traditional ILU.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection linear solver
  set method                    = amg
  set max iters                 = 200
  set minimum residual          = 1e-7
  set amg preconditioner ilu absolute tolerance    = 1e-8
  set amg preconditioner ilu relative tolerance    = 2.00
  set amg aggregation threshold = 1e-10
  set max krylov vectors        = 200
end
</pre></div>
</div>
<p><span class="raw-html"><br/></span></p>
</section>
</section>
<section id="running-the-simulation">
<h2><span class="section-number">11.5. </span>Running the Simulation<a class="headerlink" href="#running-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Launching the simulation is as simple as specifying the executable name and the parameter file. For this more complex example, it is highly advised to use <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> to parallelize the computation, with <code class="docutils literal notranslate"><span class="pre">&lt;np&gt;</span></code> the number of processes, defined accordingly with your machine’s number of cpu. The simulation can be launched by typing, in a terminal opened in the example folder:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>mpirun -np &lt;np&gt; &lt;/path/to/the/build/applications/gls_nitsche_navier_stokes_33/gls_nitsche_navier_stokes_33 mixer.prm&gt;
</pre></div>
</div>
<p>Lethe generates a larger number of files when the Nitsche immersed boundary is used:</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">mixer.pvd</span></code> contains the 3D visualization of the velocity, pressure, and auxiliary variables such as the average velocity ;</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">mixer_solid_triangulation_00.pvd</span></code>, corresponding to the Nitsche IB mesh ;</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">mixer_solid_particles_00.pvd</span></code>, corresponding to the discrete particles inserted at the Gauss points of the solid triangulation.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The solid particles enable the Nitsche restriction visualization, while the solid triangulation is used for animation purposes.</p>
</div>
<p><span class="raw-html"><br/></span></p>
<section id="results">
<h3><span class="section-number">11.5.1. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h3>
<p>The following movie shows the evolution of the velocity magnitude as a function of time in a cut perpendicular to the radius of the vessel with and without the mesh :</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/rt6PAvgMkio" width="560"></iframe><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/jvaT76qBBTs" width="560"></iframe><p>Whereas the next one show the evolution of the axial velocity pattern in the same cut:</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/8b0ETD8EkQc" width="560"></iframe><p>Finally, the following animation illustrates the axial velocity pattern in an axial cut of the vessel:</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/_VUoN8TGsJ4" width="560"></iframe><p>From these animations, we can see that the impeller generates an axial pumping flow. The fluid is diagonally propelled from the blade to the lateral walls and rises along the outer periphery of the vessel before circulating down along the shaft.</p>
<p>Although the transient flow patterns are clear, looking at the time-averaged velocity field is also relevant. The following figures show the time-averaged axial velocity in the axial plane:</p>
<blockquote>
<div><img alt="Time-averaged axial velocity" class="align-center" id="axial-velocity" src="../../../_images/averaged_axial_velocity.png"/>
</div></blockquote>
<p>Clearly, the fluid is descending along the shaft and rises along the lateral walls of the vessel.
Multiple analyses can be done with this type of simulation. For example, one can monitor the torque on the impeller as a function of the Reynolds number to generate the power curve of the agitator. One could also leverage the tracer multiphysics module to measure the mixing time of the tank and/or identify the presence of dead zones.</p>
<p><span class="raw-html"><br/></span></p>
</section>
</section>
<section id="possibilities-for-extension">
<h2><span class="section-number">11.6. </span>Possibilities for Extension<a class="headerlink" href="#possibilities-for-extension" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Increase the Reynolds number:</strong> Using a finer grid, this example can be launched at even higher Reynolds numbers. In the latter case, the flow is significantly more unsteady.</p></li>
<li><p><strong>Calculate the mixing time using the passive tracer physics:</strong> Using the passive tracer physics and the built-in post-processing tool, the mixing time in the vessel can be easily calculated.</p></li>
</ul>
<p><span class="raw-html"><br/></span></p>
</section>
<section id="references">
<h2><span class="section-number">11.7. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://onlinelibrary.wiley.com/doi/book/10.1002/0471451452">[1]</a> Paul, Edward L., Victor A. Atiemo-Obeng, and Suzanne M. Kresta, eds. Handbook of industrial mixing: science and practice. Vol. 1. John Wiley &amp; Sons, 2003.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../multiphysics/multiphysics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Multiphysics Examples</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">10. </span>3D Ribbon Mixer using a Single Rotating Reference Frame</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../../_sources/examples/incompressible-flow/3d_nitsche_mixer_with_pbt_impeller/nitsche_mixer_with_pbt_impeller.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary</a><ul>
<li><a class="reference internal" href="#features">11.1. Features</a></li>
<li><a class="reference internal" href="#locations-of-files-used-in-the-example">11.2. Locations of Files Used in the Example</a></li>
<li><a class="reference internal" href="#description-of-the-case">11.3. Description of the Case</a></li>
<li><a class="reference internal" href="#parameter-file">11.4. Parameter File</a><ul>
<li><a class="reference internal" href="#simulation-control">11.4.1. Simulation Control</a></li>
<li><a class="reference internal" href="#physical-properties">11.4.2. Physical Properties</a></li>
<li><a class="reference internal" href="#mesh">11.4.3. Mesh</a></li>
<li><a class="reference internal" href="#boundary-conditions">11.4.4. Boundary Conditions</a></li>
<li><a class="reference internal" href="#nitsche-immersed-boundary-parameters">11.4.5. Nitsche Immersed Boundary Parameters</a></li>
<li><a class="reference internal" href="#post-processing">11.4.6. Post-processing</a></li>
<li><a class="reference internal" href="#mesh-adaptation-control">11.4.7. Mesh Adaptation Control</a></li>
<li><a class="reference internal" href="#non-linear-solver-parameters">11.4.8. Non-linear Solver Parameters</a></li>
<li><a class="reference internal" href="#linear-solver-parameters">11.4.9. Linear Solver Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-simulation">11.5. Running the Simulation</a><ul>
<li><a class="reference internal" href="#results">11.5.1. Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#possibilities-for-extension">11.6. Possibilities for Extension</a></li>
<li><a class="reference internal" href="#references">11.7. References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>