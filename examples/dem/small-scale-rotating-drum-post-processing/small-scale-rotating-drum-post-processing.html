<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="5. Rotating drum" href="../rotating-drum/rotating-drum.html" /><link rel="prev" title="3. Small scale rotating drum" href="../small-scale-rotating-drum/small-scale-rotating-drum.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>4. Small scale rotating drum post-processing - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/regular_installation.html">Regular installation on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/windows_wsl.html">Windows with WSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/apple_arm.html">Installation on Apple ARM (M1 or M2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/digital_alliance.html">Running Lethe on Digital Research Alliance of Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../parameters/parameters.html">Parameters guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/cfd/cfd.html">General, CFD and Multiphysics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_multiphysics.html">Boundary Conditions - Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/box_refinement.html">Box refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dimensionality.html">Dimensionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/laser_heat_source.html">Laser heat source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/nitsche.html">Nitsche Immersed Boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/velocity_source.html">Velocity Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/volume_of_fluid.html">Volume of Fluid (Multiphase Flow)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/boundary_conditions.html">Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_mesh.html">Floating Mesh (Solid Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_wall.html">Floating Wall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/post-processing.html">Post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/timer.html">Timer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/unresolved-cfd-dem/unresolved-cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved-cfd-dem/cfd-dem.html">CFD-DEM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved-cfd-dem/void-fraction.html">Void Fraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../parameters/sharp-immersed-boundary-solver/sharp-immersed-boundary-solver.html">Sharp-Immersed-Boundary-Solver</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/detector_parameters.html">Detector parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/fem_reconstruction.html">FEM Reconstruction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/parameter_tuning.html">Parameter tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/rpt_parameters.html">RPT parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../incompressible-flow/incompressible-flow.html">Incompressible Flow</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-backward-facing-step/2d-backward-facing-step.html">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-transient-flow-around-cylinder/2d-transient-flow-around-cylinder.html">6. 2D Transient flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-flow-around-sphere/flow-around-sphere.html">7. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">8. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">9. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-mixer-using-single-rotating-frame/3d-mixer-using-single-rotating-frame.html">10. 3D Ribbon mixer using a single rotating reference frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-nitsche-mixer-with-pbt-impeller/nitsche-mixer-with-pbt-impeller.html">11. 3D Mixer with pitched-blade turbine impeller using Nitsche immersed boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../multiphysics/vof.html">1. VOF</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/dam-break/dam-break.html">1.1. Dam-break</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/rayleigh-taylor-instability/rayleigh-taylor-instability.html">1.2. Rayleigh-Taylor instability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/rising-bubble/rising-bubble.html">1.3. Rising bubble</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/3d-dam-break/3d-dam-break.html">1.4. 3D Dam Break With an Obstacle</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../multiphysics/heat-transfer.html">2. Heat transfer</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/rayleigh-benard-convection/rayleigh-benard-convection.html">2.1. Rayleigh-Bénard Convection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/stefan-problem/stefan-problem.html">2.2. Stefan problem : melting of a solid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">2.3. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/melting-cavity/melting-cavity.html">2.4. Melting Cavity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/laser-heating/laser-heating.html">2.5. Laser heating</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/laser-meltpool/laser-meltpool.html">2.6. Laser meltpool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/concentric-heat-exchanger/concentric-heat-exchanger.html">2.7. Concentric heat exchanger</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../multiphysics/tracer.html">3. Tracer</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">3.1. Tracer through CAD Junction in Simplex</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../dem.html">Discrete Element Method</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../packing-in-circle/packing-in-circle.html">1. Packing in circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../packing-in-ball/packing-in-ball.html">2. Packing in ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../small-scale-rotating-drum/small-scale-rotating-drum.html">3. Small scale rotating drum</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">4. Small scale rotating drum post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rotating-drum/rotating-drum.html">5. Rotating drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">6. Rotating drum with post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rotation-of-box/rotation-of-box.html">7. Rotation of box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../silo/silo.html">8. Silo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rectangular-hopper/rectangular-hopper.html">9. Rectangular hopper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../granular-dam-break/granular-dam-break.html">10. Granular dam-break</a></li>
<li class="toctree-l3"><a class="reference internal" href="../granular-mixer/granular-mixer.html">11. Granular mixer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unresolved-cfd-dem/unresolved-cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved-cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical packed bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved-cfd-dem/gas-solid-fluidized-bed/gas-solid-fluidized-bed.html">2. Gas-solid fluidized bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved-cfd-dem/gas-solid-spouted-bed/gas-solid-spouted-bed.html">3. Gas-solid spouted bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved-cfd-dem/boycott-effect/boycott-effect.html">4. Boycott Effect</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../sharp-immersed-boundary-solver/sharp-immersed-boundary-solver.html">Sharp Immersed Boundary Solver</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../sharp-immersed-boundary-solver/resolved-cfd-dem.html">1. Resolved CFD-DEM Examples</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../sharp-immersed-boundary-solver/sedimentation-1-particle/sedimentation-1-particle.html">1.1. Sedimentation of one particle</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../sharp-immersed-boundary-solver/incompressible-flow.html">2. Incompressible Flow</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../sharp-immersed-boundary-solver/cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">2.1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../sharp-immersed-boundary-solver/sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">2.2. Non-Newtonian flow past a sphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../sharp-immersed-boundary-solver/3d-composite-mixer-with-pbt-impeller/3d-composite-mixer-with-pbt-impeller.html">2.3. 3D Mixer with pitched-blade turbine impeller using Composite Sharp-immersed boundary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../sharp-immersed-boundary-solver/3d-opencascade-mixer-with-pbt-impeller/3d-opencascade-mixer-with-pbt-impeller.html">2.4. 3D Mixer with pitched-blade turbine impeller using OpenCascade Sharp-immersed boundary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/photon-count-calculation-in-a-cylindrical-vessel/photon-count-calculation-in-a-cylindrical-vessel.html">1. Photon count calculation in a cylindrical vessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/tuning-parameters-with-nomad/tuning-parameters-with-nomad.html">2. Tuning Count Calculation Model Parameters with NOMAD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/linear_solvers.html">Linear solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/dem/dem.html">Discret Element Method (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tools/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/gmsh/gmsh.html">Introduction on how to use GMSH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/automatic_launch/automatic_launch.html">How to automatically create and launch Lethe simulations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../referencing.html">Referencing Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="small-scale-rotating-drum-post-processing">
<h1><span class="section-number">4. </span>Small scale rotating drum post-processing<a class="headerlink" href="#small-scale-rotating-drum-post-processing" title="Permalink to this headline">¶</a></h1>
<p>This is an example of how to post-process results obtained in the <a class="reference external" href="../../dem/rotating-drum/small-scale-rotating-drum.html">Small scale rotating drum example</a> using <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools</a>, a Python module is based on <a class="reference external" href="https://docs.pyvista.org/">PyVista</a>, built to facilitate the reading of Lethe results using <a class="reference external" href="https://www.python.org/">Python</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This example uses the DEM files of the <a class="reference external" href="../../dem/rotating-drum/small-scale-rotating-drum.html">Small scale rotating drum example</a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools</a> to work, along with <a class="reference external" href="https://www.python.org/downloads/">Python 3</a>, the following libraries are needed: <a class="reference external" href="https://docs.python.org/3/library/os.html">os</a>, <a class="reference external" href="https://numpy.org/">NumPy</a>, <a class="reference external" href="https://docs.pyvista.org/">PyVista</a>, <a class="reference external" href="https://tqdm.github.io/">tqdm</a>, <a class="reference external" href="https://matplotlib.org/stable/index.html">matplotlib</a>, and <a class="reference external" href="https://scipy.org/">SciPy</a>, and <a class="reference external" href="https://scikit-learn.org/stable/index.html">scikit-learn</a>. If any of the modules are missing, use <a class="reference external" href="https://pypi.org/project/pip/">pip</a> to install it running <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">$NAME_OF_THE_MODULE</span></code> on the terminal.</p>
</div>
<section id="features">
<h2><span class="section-number">4.1. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>DEM simulation</p></li>
<li><p>Post-processing using <a class="reference external" href="https://www.python.org/">Python</a>, <a class="reference external" href="https://docs.pyvista.org/">PyVista</a>, <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools</a>, and <a class="reference external" href="https://www.paraview.org/">ParaView</a>.</p></li>
</ul>
</section>
<section id="files-used-in-this-example">
<h2><span class="section-number">4.2. </span>Files used in this example<a class="headerlink" href="#files-used-in-this-example" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Parameters file for particle insertion: <code class="docutils literal notranslate"><span class="pre">/examples/dem/3d-small-scale-rotating-drum/packing-rotating-drum.prm</span></code></p></li>
<li><p>Parameters file for drum rotation: <code class="docutils literal notranslate"><span class="pre">/examples/dem/3d-small-scale-rotating-drum/small-rotating-drum-dem.prm</span></code></p></li>
<li><p>Python module for Lethe data post-processing: <code class="docutils literal notranslate"><span class="pre">/contrib/postprocessing/lethe_pyvista_tools.py</span></code></p></li>
<li><p>Python script using module for rotating drum post-processing: <code class="docutils literal notranslate"><span class="pre">/examples/postprocessing/small-scale-rotating-drum-postprocessing/example_small_rotating_drum.py</span></code></p></li>
</ul>
</section>
<section id="description-of-the-case">
<h2><span class="section-number">4.3. </span>Description of the case<a class="headerlink" href="#description-of-the-case" title="Permalink to this headline">¶</a></h2>
<p>In this example, we illustrate the mixing inside a rotating drum by coloring the particles according to their radial position right after their full packing. To do so, we post-process Lethe-DEM data using <a class="reference external" href="https://www.python.org/">Python</a>, <a class="reference external" href="https://docs.pyvista.org/">PyVista</a>, <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools</a>, and <a class="reference external" href="https://www.paraview.org/">ParaView</a>.</p>
<p>Additionally, we calculate the mixing index using the Nearest Neighbors Method (NNM) [<a class="reference external" href="https://www.researchgate.net/profile/Niels-Deen/publication/228722534_Characterizing_solids_mixing_in_DEM_simulations/links/00b495289f429c5b39000000/Characterizing-solids-mixing-in-DEM-simulations.pdf">1</a>] and Doucet method [<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0263876208002724">2</a>, <a class="reference external" href="https://doi.org/10.1016/j.cherd.2016.12.018">3</a>].</p>
<p>The DEM files used in this example are obtained following the <a class="reference external" href="../../dem/rotating-drum/small-scale-rotating-drum.html">Small scale rotating drum example</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not necessary to use all mentioned tools, but they are used in this example to show different ways to process the data according to user’s need.</p>
</div>
</section>
<section id="python-code">
<h2><span class="section-number">4.4. </span>Python code<a class="headerlink" href="#python-code" title="Permalink to this headline">¶</a></h2>
<section id="module-importing">
<h3><span class="section-number">4.4.1. </span>Module importing<a class="headerlink" href="#module-importing" title="Permalink to this headline">¶</a></h3>
<p>The module <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools</a> was conceived to optimize the reading and post-treatment of Lethe data using Python. It is based on <a class="reference external" href="https://docs.pyvista.org/">PyVista</a>, a versatile module that can be used to manipulate Lethe results.</p>
<p>First of all, we import the module to our Python script. There are two ways to do so. In the case of this example, we use the <a class="reference external" href="https://docs.python.org/3/library/sys.html">sys</a> module to import it directly from Lethe’s directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">path_to_module</span> <span class="o">=</span> <span class="s1">'../../../contrib/postprocessing/'</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_to_module</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">lethe_pyvista_tools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>where <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path:~:text=in%20version%203.10.-,sys.path%C2%B6,-A%20list%20of">sys.path</a> is a list of strings that specifies the search path for modules. However, one can simply copy the <a class="reference external" href="https://github.com/lethe-cfd/lethe/tree/master/contrib/postprocessing">lethe_pyvista_tools.py</a> file to the same folder as the Python post-processing script is and import it, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lethe_pyvista_tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>One third and very convenient way to always import the module without copying it or even adding the <code class="docutils literal notranslate"><span class="pre">sys.path.append(path_to_module)</span></code> is permanentely adding the path to the module (<code class="docutils literal notranslate"><span class="pre">/contrib/postprocessing/</span></code>) to your <a class="reference external" href="https://docs.python.org/3/library/sys_path_init.html#:~:text=The%20PYTHONPATH%20environment%20variable%20is,all%20installed%20Python%20versions%2Fenvironments.">PYTHONPATH</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">*</span></code> means that we want to import all members of lethe_pyvista_tools.</p>
</section>
<section id="constructing-the-object">
<h3><span class="section-number">4.4.2. </span>Constructing the object<a class="headerlink" href="#constructing-the-object" title="Permalink to this headline">¶</a></h3>
<p>The following step is to create an object to receive the data. In the present case, the object is called <code class="docutils literal notranslate"><span class="pre">particles</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span> <span class="o">=</span> <span class="n">lethe_pyvista_tools</span><span class="p">(</span><span class="n">case_path</span> <span class="o">=</span> <span class="s2">"."</span><span class="p">,</span> <span class="n">prm_file_name</span> <span class="o">=</span> <span class="s2">"small-rotating-drum-dem.prm"</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the constructor <code class="docutils literal notranslate"><span class="pre">lethe_pyvista_tools</span></code> receives two arguments: <code class="docutils literal notranslate"><span class="pre">case_path</span></code> and <code class="docutils literal notranslate"><span class="pre">prm_file_name</span></code>. In the above code line, <code class="docutils literal notranslate"><span class="pre">"."</span></code> means that the <code class="docutils literal notranslate"><span class="pre">case_path</span></code> is the path where we currently are, but it can be any path where the case is. The <code class="docutils literal notranslate"><span class="pre">prm_file_name</span></code> argument takes <code class="docutils literal notranslate"><span class="pre">"small-rotating-drum-dem.prm"</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Together with the object <code class="docutils literal notranslate"><span class="pre">particles</span></code>, <code class="docutils literal notranslate"><span class="pre">lethe_pyvista_tools</span></code> creates a dictionary with all parameters in the <code class="docutils literal notranslate"><span class="pre">.prm</span></code> file. To access the parameter, we can use <code class="docutils literal notranslate"><span class="pre">particles.prm_dict['$NAME_OF_THE_PARAMETER']</span></code>. In the present case for example, the diameter of the particles can be easily printed using <code class="docutils literal notranslate"><span class="pre">print(particles.prm_dict['diameter'])</span></code>. This can be useful for post-processing routines with multiple simulations.</p>
</div>
</section>
<section id="reading-lethe-results-to-python">
<h3><span class="section-number">4.4.3. </span>Reading Lethe results to Python<a class="headerlink" href="#reading-lethe-results-to-python" title="Permalink to this headline">¶</a></h3>
<p>Next, we read the results into Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">read_lethe_to_pyvista</span><span class="p">(</span><span class="n">pvd_name</span> <span class="o">=</span> <span class="s2">"out.pvd"</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">read_lethe_to_pyvista</span></code> takes the name of the <code class="docutils literal notranslate"><span class="pre">.pvd</span></code> file generated by the simulation. The method can take 3 other arguments: <code class="docutils literal notranslate"><span class="pre">first</span></code>, <code class="docutils literal notranslate"><span class="pre">last</span></code>, and <code class="docutils literal notranslate"><span class="pre">interval</span></code>, standing for the first and last time-steps to be read and the interval between the time-steps, respectively. By default, <code class="docutils literal notranslate"><span class="pre">first</span> <span class="pre">=</span> <span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">interval</span> <span class="pre">=</span> <span class="pre">1</span></code>, and <code class="docutils literal notranslate"><span class="pre">last</span></code> is the last time-step of the data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">read_lethe_to_pyvista</span></code> reading function assigns the datasets of each time-step to the object <code class="docutils literal notranslate"><span class="pre">particles</span></code>. Each time-step corresponds to a <a class="reference external" href="https://docs.pyvista.org/user-guide/vtk_to_pyvista.html#">PyVista dataset</a>, and can be accessed using <code class="docutils literal notranslate"><span class="pre">particles.df[$TIME-step_NUMBER]</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we set <code class="docutils literal notranslate"><span class="pre">first</span> <span class="pre">=</span> <span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">particles.df[0]</span></code> corresponds to the dataset of the 2nd output time-step. In all situations from now on, everytime we refer to a time-step, it will correspond to a dataset.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Since this is a post-processing module, we can only have access to data that was previously output. If one needs more time resolution than the data in hand, the simulation must be <a class="reference external" href="../../../parameters/dem/simulation_control">reran with a smaller time-step</a></p>
</div>
</section>
<section id="creation-of-a-new-array">
<h3><span class="section-number">4.4.4. </span>Creation of a new array<a class="headerlink" href="#creation-of-a-new-array" title="Permalink to this headline">¶</a></h3>
<p>To color the particles according to their position, we use the function <code class="docutils literal notranslate"><span class="pre">modify_array</span></code>, which takes the following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reference_array_name</span></code>: Name of the array used to sort the data and identify the particles at all time-steps. Other arrays, such as <code class="docutils literal notranslate"><span class="pre">Type</span></code> or any other array, can be used for this. By default: <code class="docutils literal notranslate"><span class="pre">"ID"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array_name</span></code>: Name of the new array. If there is an array with the same name, it will be rewritten according to the other arguments. By default: <code class="docutils literal notranslate"><span class="pre">"new_array"</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restart_array</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, gives <code class="docutils literal notranslate"><span class="pre">standard_value</span></code> to the entire array before applying the modifications to it. If one wants to modify part of the array keeping the rest intact, it must be set as <code class="docutils literal notranslate"><span class="pre">False</span></code>. By default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code>: Takes a string and uses it in an if condition to modify the array. Variables accepted include <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">v</span></code>, <code class="docutils literal notranslate"><span class="pre">w</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, and any other array (<code class="docutils literal notranslate"><span class="pre">ID</span></code> for example). It also accepts a combination of them, such as <code class="docutils literal notranslate"><span class="pre">"x*w**2</span> <span class="pre">+</span> <span class="pre">t</span> <span class="pre">&gt;</span> <span class="pre">2</span> <span class="pre">and</span> <span class="pre">ID</span> <span class="pre">&gt;</span> <span class="pre">0"</span></code>. By default: <code class="docutils literal notranslate"><span class="pre">""</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array_values</span></code>: New values to the array. This argument accepts a single value (which will be repeated to all data respecting the given <code class="docutils literal notranslate"><span class="pre">condition</span></code>), a <a class="reference external" href="https://numpy.org/">NumPy</a> array, or <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html">Python list</a> (with the same length (<code class="docutils literal notranslate"><span class="pre">len</span></code>) of all other arrays in <code class="docutils literal notranslate"><span class="pre">particles.df</span></code>), or a string such as <code class="docutils literal notranslate"><span class="pre">"2*x</span> <span class="pre">+</span> <span class="pre">t"</span></code> (working just like the <code class="docutils literal notranslate"><span class="pre">condition</span></code> argument). By default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">standard_value</span></code>: If <code class="docutils literal notranslate"><span class="pre">restart</span> <span class="pre">array</span> <span class="pre">=</span> <span class="pre">True</span></code> or the array is a completely new array, the <code class="docutils literal notranslate"><span class="pre">standard_value</span></code> will be plugged to the entire array before modifying it. By default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_dependent</span></code>: <code class="docutils literal notranslate"><span class="pre">modify_array</span></code> can be time dependent or not. If set <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">condition</span></code> will be tested to each of the time-steps, while if it is <code class="docutils literal notranslate"><span class="pre">False</span></code>, it will be applied using the <code class="docutils literal notranslate"><span class="pre">reference_time_step</span></code> instead, and the modification will be just replicated to the other time-steps. By default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference_time_step</span></code>: Reference time-step to which the modification will be applied. If <code class="docutils literal notranslate"><span class="pre">time_dependent</span> <span class="pre">=</span> <span class="pre">False</span></code>, the result of the modificaition applied to <code class="docutils literal notranslate"><span class="pre">reference_time_step</span></code> will be simply replicated to the others. By default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>As explained in the previous subsection, <code class="docutils literal notranslate"><span class="pre">reference_time_step</span></code> only refers to time-steps that were read into the code using <code class="docutils literal notranslate"><span class="pre">read_lethe_to_pyvista</span></code>.</p>
</div>
<p>The following block of code creates an array named <code class="docutils literal notranslate"><span class="pre">particle_color</span></code> using the <code class="docutils literal notranslate"><span class="pre">modify_array</span></code> function, assigning <code class="docutils literal notranslate"><span class="pre">1</span></code> to all particles with radial position <span class="math notranslate nohighlight">\(&gt; 0.025\)</span> at the end of the packing (40th time-step):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="s2">"(y**2 + z**2)**(1/2) &gt; 0.025"</span>
<span class="n">particles</span><span class="o">.</span><span class="n">modify_array</span><span class="p">(</span><span class="n">array_name</span> <span class="o">=</span> <span class="s2">"particle_color"</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span><span class="p">,</span> <span class="n">array_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">reference_time_step</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>Since the rotating drum is placed along the <span class="math notranslate nohighlight">\(x\)</span> axis, we use <span class="math notranslate nohighlight">\(\sqrt{y^2 + z^2}\)</span> to assess the radial position of particles.</p>
<p>To create an additional layer of particles with different colors, we use the same function again with a different condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="s2">"(y**2 + z**2)**(1/2) &gt; 0.04"</span>
<span class="n">particles</span><span class="o">.</span><span class="n">modify_array</span><span class="p">(</span><span class="n">array_name</span> <span class="o">=</span> <span class="s2">"particle_color"</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span><span class="p">,</span> <span class="n">array_values</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">reference_time_step</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">restart_array</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This time, we set <code class="docutils literal notranslate"><span class="pre">restart_array</span> <span class="pre">=</span> <span class="pre">False</span></code> to guarantee it is not going to affect the previous modification to the array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we applied the second condition first, since conditions would overlap, intead of 3 layers of particles we would have only two.</p>
</div>
</section>
</section>
<section id="visualizing-the-results">
<h2><span class="section-number">4.5. </span>Visualizing the results<a class="headerlink" href="#visualizing-the-results" title="Permalink to this headline">¶</a></h2>
<p>We have two visualization options. One would be the <a class="reference external" href="https://docs.pyvista.org/api/plotting/index.html">PyVista visualization tools</a>, such as <a class="reference external" href="https://docs.pyvista.org/api/plotting/_autosummary/pyvista.Plotter.html#pyvista.Plotter">PyVista Plotter</a>. The other option is to use <a class="reference external" href="https://www.paraview.org/">ParaView</a>.</p>
<section id="pyvista-visualization">
<h3><span class="section-number">4.5.1. </span>PyVista visualization<a class="headerlink" href="#pyvista-visualization" title="Permalink to this headline">¶</a></h3>
<p>To visualize particle data using PyVista, first we need to create a single particle with diameter 1 and a given angular resolution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sphere</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">theta_resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">phi_resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to use this object as base to represent all particles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particle_glyph</span> <span class="o">=</span> <span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">glyph</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s1">'Diameter'</span><span class="p">,</span> <span class="n">geom</span> <span class="o">=</span> <span class="n">sphere</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we are using the first time-step of the data (<code class="docutils literal notranslate"><span class="pre">particles.df[0]</span></code>) as example.</p>
<p>Now that particles are created, we can visualize them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">particle_glyph</span><span class="p">,</span> <span class="n">scalars</span> <span class="o">=</span> <span class="s2">"particle_color"</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This will open one iteractive window such as this one:</p>
<img alt="PyVista visualization window" class="align-center" src="../../../_images/pyvista_window.png"/>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to <a class="reference external" href="https://docs.pyvista.org/api/plotting/_autosummary/pyvista.BasePlotter.open_movie.html#open-movie">create movies with PyVista</a> looping through time-steps.</p>
</div>
</section>
<section id="paraview-visualization">
<h3><span class="section-number">4.5.2. </span>ParaView visualization<a class="headerlink" href="#paraview-visualization" title="Permalink to this headline">¶</a></h3>
<p>First, we need to save the new data with the modifications. To do so, we can use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">write_vtu</span><span class="p">(</span><span class="n">prefix</span> <span class="o">=</span> <span class="s2">"mod_"</span><span class="p">)</span>
</pre></div>
</div>
<p>This will save all data in the output folder of the simulation. All files will have a <code class="docutils literal notranslate"><span class="pre">prefix</span></code> and can be opened in ParaView just like any other Lethe simulation.</p>
<img alt="ParaView" class="align-center" src="../../../_images/paraview_window.png"/>
<img alt="ParaView zoom in" class="align-center" src="../../../_images/paraview_window_zoom.png"/>
</section>
</section>
<section id="mixing-index">
<h2><span class="section-number">4.6. </span>Mixing index<a class="headerlink" href="#mixing-index" title="Permalink to this headline">¶</a></h2>
<p>We used two methods to calculate the mixing index of the rotating drum:</p>
<ul class="simple">
<li><p>Nearest Neighbors Method (NNM) [<a class="reference external" href="https://www.researchgate.net/profile/Niels-Deen/publication/228722534_Characterizing_solids_mixing_in_DEM_simulations/links/00b495289f429c5b39000000/Characterizing-solids-mixing-in-DEM-simulations.pdf">1</a>].</p></li>
<li><p>Doucet method [<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0263876208002724">2</a>, <a class="reference external" href="https://doi.org/10.1016/j.cherd.2016.12.018">3</a>].</p></li>
</ul>
<section id="nearest-neighbors-method">
<h3><span class="section-number">4.6.1. </span>Nearest Neighbors Method<a class="headerlink" href="#nearest-neighbors-method" title="Permalink to this headline">¶</a></h3>
<p>One example of application of the <code class="docutils literal notranslate"><span class="pre">modify_array</span></code> method is on the calculation of the mixing index using the Nearest Neighbors Method (NNM) [<a class="reference external" href="https://www.researchgate.net/profile/Niels-Deen/publication/228722534_Characterizing_solids_mixing_in_DEM_simulations/links/00b495289f429c5b39000000/Characterizing-solids-mixing-in-DEM-simulations.pdf">1</a>]. To do so, we first need to split the domain in half. Since we are interested on working with the radial mixing, first we need to calculate the cylindric coordinates of each particle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">get_cylindrical_coords</span><span class="p">(</span><span class="n">radial_components</span> <span class="o">=</span> <span class="s2">"yz"</span><span class="p">)</span>
</pre></div>
</div>
<p>Given the radial components, this method assigns <code class="docutils literal notranslate"><span class="pre">.points_cyl</span></code> to the object <code class="docutils literal notranslate"><span class="pre">particles</span></code>. The coordinates <span class="math notranslate nohighlight">\([0, 1, 2]\)</span> are <span class="math notranslate nohighlight">\([r, \theta, Z]\)</span>, respectively</p>
<p>To help us finding where to split the domain, we will also find the radial coordinate of the center of mass of the particles at <code class="docutils literal notranslate"><span class="pre">reference_time_step</span> <span class="pre">=</span> <span class="pre">40</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r_center_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">points_cyl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Now we can split the domain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">condition</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"(y**2 + z**2)**(1/2) &gt; </span><span class="si">{</span><span class="n">r_center_mass</span><span class="si">}</span><span class="s2">"</span>
<span class="n">particles</span><span class="o">.</span><span class="n">modify_array</span><span class="p">(</span><span class="n">array_name</span> <span class="o">=</span> <span class="s2">"particle_color"</span><span class="p">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span><span class="p">,</span> <span class="n">array_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">restart_array</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">reference_time_step</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We need to set <code class="docutils literal notranslate"><span class="pre">restart_array</span> <span class="pre">=</span> <span class="pre">True</span></code> since we are doing a new split on the particles using the same <code class="docutils literal notranslate"><span class="pre">array_name</span> <span class="pre">=</span> <span class="pre">'particle_color'</span></code>.</p>
</div>
<p>The following method is used to find the <code class="docutils literal notranslate"><span class="pre">15</span></code> nearest neighbors of each particle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">get_nearest_neighbors</span><span class="p">(</span><span class="n">return_id</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the indice and the position of the nearest neighbor (<cite>0</cite>) of particle <cite>2</cite> at the 5th time-step, the following can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">neighbor_indice</span> <span class="o">=</span> <span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">neighbor_indice</span><span class="p">])</span>
</pre></div>
</div>
<p>It is also possible to print the neighbor’s <cite>ID</cite> and its distance to particle <abbr>2</abbr></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">neighbors_id</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">neighbors_dist</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>All set, now we can calculate the mixing index using NNM and store it in <cite>particles.mixing_index_nnm</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_nearest_neighbors</span><span class="p">(</span><span class="n">reference_array</span> <span class="o">=</span> <span class="s2">"particle_color"</span><span class="p">,</span> <span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">mixing_index_array_name</span> <span class="o">=</span> <span class="s2">"mixing_index_NNM"</span><span class="p">)</span>
<span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_nnm</span> <span class="o">=</span> <span class="n">particles</span><span class="o">.</span><span class="n">mixing_index</span>
</pre></div>
</div>
<p>This method calculates the mixing index for each particles and stores it in an array named according to the parameter <cite>mixing_index_array_name</cite>. This array can be used for vizualization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">write_vtu</span><span class="p">(</span><span class="n">prefix</span> <span class="o">=</span> <span class="s2">"mix_"</span><span class="p">)</span>
</pre></div>
</div>
<p>The same way as before, <code class="docutils literal notranslate"><span class="pre">vtu</span></code> and <code class="docutils literal notranslate"><span class="pre">pvd</span></code> will be stored with prefix <code class="docutils literal notranslate"><span class="pre">"mix_"</span></code> in the output folder of the simulation.</p>
<img alt="ParaView zoom in NNM" class="align-center" src="../../../_images/paraview_window_zoom_nnm.png"/>
</section>
<section id="doucet-mixing-index">
<h3><span class="section-number">4.6.2. </span>Doucet mixing index<a class="headerlink" href="#doucet-mixing-index" title="Permalink to this headline">¶</a></h3>
<p>Similar to NNM, we are interested in the mixing index results using cylindrical coordinates. Calculating the Doucet mixing index is as simple as running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_doucet</span><span class="p">(</span><span class="n">reference_time_step</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">use_cyl</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">increasing_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_doucet</span> <span class="o">=</span> <span class="n">particles</span><span class="o">.</span><span class="n">mixing_index</span>
</pre></div>
</div>
<p>Usually, Doucet mixing index decreases with mixing, but for comparison with NNM purposes we do <code class="docutils literal notranslate"><span class="pre">increasing_index</span> <span class="pre">=</span> <span class="pre">True</span></code>. Doucet method does not need any sort of splitting of particles, so it is not necessary to split them previous to using this method.</p>
</section>
</section>
<section id="results">
<h2><span class="section-number">4.7. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>Following we present one video of the full simulation with particles colored by their initial position.</p>
<iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/qxO4MD_zg2w" title="Rotating drum - mixing study" width="560"></iframe><p>The simulation results show that the layers in red and green, that is, particles close to the walls, tend to mix faster than the ones in the center.</p>
<p>The poor mixing of the particles is confirmed with NNM and Doucet mixing indices. To plot both indices as a function of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_nnm</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="s1">'-b'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">"Generalized NNM"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="n">particles</span><span class="o">.</span><span class="n">mixing_index_doucet</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="s1">'--k'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">"Doucet"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="mi">40</span><span class="p">:],</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="mi">40</span><span class="p">:])),</span> <span class="s1">':r'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Time [s]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Mixing index [-]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="mi">40</span><span class="p">],</span> <span class="n">particles</span><span class="o">.</span><span class="n">time_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"./mixing_index.png"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">rotational</span> <span class="pre">speed</span> <span class="pre">=</span> <span class="pre">2</span></code>, the following is observed:</p>
<img alt="ParaView zoom in NNM" class="align-center" src="../../../_images/mixing_indices_comparison.png"/>
<p>As shown, neither of the mixing indices point to a full mixing of the particles, even at higher simulation times. NNM is always above Doucet, indicating that the main mixing component must not be the radius. Higher rotating velocities can improve results.</p>
</section>
<section id="possibilities-for-extension">
<h2><span class="section-number">4.8. </span>Possibilities for extension<a class="headerlink" href="#possibilities-for-extension" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Give a different <code class="docutils literal notranslate"><span class="pre">condition</span></code> to create the <code class="docutils literal notranslate"><span class="pre">particle_color</span></code> array</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">lethe_pyvista_tools</span></code> for a different problem, modifying the <code class="docutils literal notranslate"><span class="pre">condition</span></code> accordingly</p></li>
<li><p>Use the tools in the <a class="reference external" href="https://docs.pyvista.org">PyVista official repository</a> to create screenshots, movies, and plots with the data.</p></li>
<li><p>Change the rotation velocity and track the mixing indices.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../rotating-drum/rotating-drum.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">5. </span>Rotating drum</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../small-scale-rotating-drum/small-scale-rotating-drum.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">3. </span>Small scale rotating drum</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../../_sources/examples/dem/small-scale-rotating-drum-post-processing/small-scale-rotating-drum-post-processing.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">4. Small scale rotating drum post-processing</a><ul>
<li><a class="reference internal" href="#features">4.1. Features</a></li>
<li><a class="reference internal" href="#files-used-in-this-example">4.2. Files used in this example</a></li>
<li><a class="reference internal" href="#description-of-the-case">4.3. Description of the case</a></li>
<li><a class="reference internal" href="#python-code">4.4. Python code</a><ul>
<li><a class="reference internal" href="#module-importing">4.4.1. Module importing</a></li>
<li><a class="reference internal" href="#constructing-the-object">4.4.2. Constructing the object</a></li>
<li><a class="reference internal" href="#reading-lethe-results-to-python">4.4.3. Reading Lethe results to Python</a></li>
<li><a class="reference internal" href="#creation-of-a-new-array">4.4.4. Creation of a new array</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualizing-the-results">4.5. Visualizing the results</a><ul>
<li><a class="reference internal" href="#pyvista-visualization">4.5.1. PyVista visualization</a></li>
<li><a class="reference internal" href="#paraview-visualization">4.5.2. ParaView visualization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mixing-index">4.6. Mixing index</a><ul>
<li><a class="reference internal" href="#nearest-neighbors-method">4.6.1. Nearest Neighbors Method</a></li>
<li><a class="reference internal" href="#doucet-mixing-index">4.6.2. Doucet mixing index</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results">4.7. Results</a></li>
<li><a class="reference internal" href="#possibilities-for-extension">4.8. Possibilities for extension</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>