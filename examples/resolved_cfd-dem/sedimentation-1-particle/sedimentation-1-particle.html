<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="3. Non-Newtonian flow past a sphere" href="../sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html" /><link rel="prev" title="1. Flow around a cylinder using the sharp interface method" href="../cylinder-with-sharp-interface/cylinder-with-sharp-interface.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>2. Sedimentation of one particle. - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/regular_installation.html">Regular installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/apple_arm.html">Installation on Apple ARM (M1 or M2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/digital_alliance.html">Running Lethe on Digital Research Alliance of Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../parameters/parameters.html">Parameters guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/cfd/cfd.html">General, CFD and Multiphysics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/volume_of_fluid.html">Multiphase Flow - Volume of Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_multiphysics.html">Boundary Contitions - Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/nitsche.html">Nitsche</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/laser_heat_source.html">Laser heat source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/box_refinement.html">Box refinement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/velocity_source.html">Velocity Source</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_wall.html">Floating Wall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_mesh.html">Floating Mesh (Solid Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/void_fraction.html">Void Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/cfd_dem.html">CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../parameters/resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/rpt_parameters.html">RPT parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/detector_parameters.html">Detector parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/parameter_tuning.html">Parameter tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/rpt/fem_reconstruction.html">FEM Reconstruction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../incompressible-flow/incompressible-flow.html">Incompressible Flow</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-backward-facing-step/2d-backward-facing-step.html">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-transient-flow-around-cylinder/2d-transient-flow-around-cylinder.html">6. 2D Transient flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-flow-around-sphere/flow-around-sphere.html">7. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">8. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">9. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d_mixer_using_single_rotating_frame/3d_mixer_using_single_rotating_frame.html">10. 3D Ribbon Mixer using a Single Rotating Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../incompressible-flow/3d_nitsche_mixer_with_pbt_impeller/nitsche_mixer_with_pbt_impeller.html">11. 3D Mixer with Pitched-Blade Turbine Impeller using Nitsche Immersed Boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">1. Tracer through CAD Junction in Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rayleigh-benard-convection/rayleigh-benard-convection.html">2. Rayleigh-Bénard Convection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/stefan_problem/stefan_problem.html">3. Stefan problem : melting of a solid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">4. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/dam-break-VOF/dam-break-VOF.html">5. Dam break VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rising-bubble-VOF/rising-bubble-VOF.html">6. Rising bubble VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/melting-cavity/melting-cavity.html">7. Melting Cavity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-heating/laser-heating.html">8. Laser heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-meltpool/laser-meltpool.html">9. Laser meltpool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dem/dem.html">Discrete Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-circle/packing-in-circle.html">1. Packing in Circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-ball/packing-in-ball.html">2. Packing in Ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum/rotating-drum.html">3. Rotating Drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">4. Rotating Drum with Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotation-of-box/rotation-of-box.html">5. Rotation of Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/silo/silo.html">6. Silo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/3d-small-scale-rotating-drum/3d-small-scale-rotating-drum.html">7. Small Scale Rotating Drum (3D)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/granular-mixer/granular-mixer.html">8. Granular Mixer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical Packed Bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/square-fluidized-bed/square-fluidized-bed.html">2. Gas-Solid Fluidized Bed</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../resolved_cfd-dem.html">Resolved CFD-DEM Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">2. Sedimentation of one particle.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">3. Non-Newtonian flow past a sphere</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../rpt/rpt.html">Radioactive Particle Tracking (RPT)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/photon-count-calculation-in-a-cylindrical-vessel/photon-count-calculation-in-a-cylindrical-vessel.html">1. Photon Count Calculation in a Cylindrical Vessel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpt/tuning-parameters-with-nomad/tuning-parameters-with-nomad.html">2. Tuning Count Calculation Model Parameters with NOMAD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/linear_solvers.html">Linear solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/dem/dem.html">Discret Element Method (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tools/tools.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/gmsh/gmsh.html">Introduction on how to use GMSH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../referencing.html">Referencing Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="sedimentation-of-one-particle">
<h1><span class="section-number">2. </span>Sedimentation of one particle.<a class="headerlink" href="#sedimentation-of-one-particle" title="Permalink to this headline">¶</a></h1>
<p>This example aims to numerically reproduce the results obtained by Ten Cate <cite>et al.</cite> <a class="reference external" href="https://doi.org/10.1063/1.1512918">[1]</a> for the E4 experience. This experience measures the velocity of the sedimentation of a 1.5 cm particle in a container filled with a viscous fluid. The container is sufficiently small to impact the particle sedimentation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This case is a computationally expensive example. It can take several hours to run.</p></li>
<li><p>This case is designed with the upcomming IB_contact_and_stability features.</p></li>
</ul>
</div>
<section id="features">
<h2><span class="section-number">2.1. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Solvers: <code class="docutils literal notranslate"><span class="pre">gls_sharp_navier_stokes_3d</span></code> (with Q1-Q1)</p></li>
<li><p>Transient problem</p></li>
<li><p>Displays the capability of the resolved CFD-DEM solver for the flow around one particle</p></li>
</ul>
</section>
<section id="description-of-the-case">
<h2><span class="section-number">2.2. </span>Description of the case<a class="headerlink" href="#description-of-the-case" title="Permalink to this headline">¶</a></h2>
<p>The E4 experiment consists in the release of a particle made of Nylon (<span class="math notranslate nohighlight">\(\rho_p=0.001120 \frac{\text{kg}}{\text{cm}^{3}}\)</span>)  with a diameter of 1.5cm. The center of the particle is located 12.75 cm above the bottom of a 10x16x10 cm container. The viscosity of the fluid is <span class="math notranslate nohighlight">\(\mu_f=0.00058 \frac{\text{kg}}{\text{s cm}}\)</span> which is equivalent to <span class="math notranslate nohighlight">\(\mu_f=0.058 \frac{\text{N s}}{\text{m}^{2}}\)</span>. The density of the fluid is <span class="math notranslate nohighlight">\(\rho_f=0.000960 \frac{\text{kg}}{\text{cm}^{3}}\)</span>. The gravity constant is <span class="math notranslate nohighlight">\(g= -981 \frac{\text{cm}}{\text{s}^{2}}\)</span>. The particle accelerates due to gravity until it hits the bottom of the container, at which point we stop the simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will note that we have transformed every length unit into centimeters. The reason is that the particle’s size is very close to 1 cm. Representing the problem in this way helps the linear solver converge. It avoids extremely small values in the matrix due to the volume of cells being expressed in <span class="math notranslate nohighlight">\(\text{cm}^{3}\)</span> instead of <span class="math notranslate nohighlight">\(\text{m}^{3}\)</span>.</p>
</div>
<p>All the container walls have no-slip boundary conditions except at the top of the container, where we define an open boundary.</p>
</section>
<section id="location-of-the-examples">
<h2><span class="section-number">2.3. </span>Location of the examples<a class="headerlink" href="#location-of-the-examples" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">/examples/resolved-cfd-dem/sedimentation_1_particle/sedimentation_1_particle.prm</span></code></p>
</div></blockquote>
</section>
<section id="parameter-file">
<h2><span class="section-number">2.4. </span>Parameter file<a class="headerlink" href="#parameter-file" title="Permalink to this headline">¶</a></h2>
<p>We explain every part of this prm file in detail. In each section of the parameter file, we describe relevant parameters. The omitted parameters are only user preference parameters and do not impact the simulation results. For more detail on these parameter we suggest visiting the <a class="reference internal" href="../../../parameters/parameters.html"><span class="doc">Parameters guide</span></a>.</p>
<section id="simulation-and-io-control">
<h3><span class="section-number">2.4.1. </span>Simulation and IO Control<a class="headerlink" href="#simulation-and-io-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection simulation control
  set method                  = bdf2
  set bdf startup method      = multiple step bdf
  set time step               = 0.0025 # Time step
  set time end                = 1.3  # End time of simulation
  set output name             = out # Prefix for VTU outputs
  set output frequency        = 1       # Frequency of simulation output
  set subdivision             = 1       # Mesh subdivision when outputend
end
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">method</span></code> is set to  <code class="docutils literal notranslate"><span class="pre">bdf2</span></code> to have a second-order time-stepping method. This ensures a low error due to the time discretization in this case.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">bdf</span> <span class="pre">startup</span> <span class="pre">method</span></code> is set to  <code class="docutils literal notranslate"><span class="pre">multiple</span> <span class="pre">step</span> <span class="pre">bdf</span></code>  as we do not have an initial solution that allows us to generate previous time steps. The sharp interface immersed boundary is not compatible at this point with the sdirk solver. This leaves us with the multiple step bdf approach that will ramp the order of the scheme in the first few time steps.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">step</span></code> is set to  0.0025. This ensures a low error due to the time discretization for this case.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">time</span> <span class="pre">end</span></code> is set to  1.3. This is slightly longer than the experimental results of Ten Cate <cite>et al.</cite> <a class="reference external" href="https://doi.org/10.1063/1.1512918">[1]</a>. This ensures that the entire trajectory of the particle has been simulated.</p></li>
</ul>
</section>
<section id="physical-properties">
<h3><span class="section-number">2.4.2. </span>Physical Properties<a class="headerlink" href="#physical-properties" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection physical properties
  subsection fluid 0
    set kinematic viscosity            =0.6041666666666
    set density =0.000960
  end
end
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">kinematic</span> <span class="pre">viscosity</span></code> is set to  0.6041666666666. This value is derived from the case description by dividing <span class="math notranslate nohighlight">\(\mu_f\)</span> by <span class="math notranslate nohighlight">\(\rho_f\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>text
The fluid density is not set here as the sharp interface solver has his own definition of the density of the fluid. This will be modified soon to unify both definitions in the parameter.</p>
</div>
</section>
<section id="fem">
<h3><span class="section-number">2.4.3. </span>FEM<a class="headerlink" href="#fem" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection FEM
    set velocity order        = 1
    set pressure order        = 1
end
</pre></div>
</div>
<p>Here we use Q1Q1 elements. This case is only for demonstration purposes as such we want to propose a simulation that is not too costly to run.</p>
</section>
<section id="mesh">
<h3><span class="section-number">2.4.4. </span>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh
    set type                 = dealii
    set grid type            = subdivided_hyper_rectangle
    set grid arguments       = 5,8,5: 0,0,0 : 10 , 16 ,10 : true
    set initial refinement   = 1
end
</pre></div>
</div>
<p>The domain is a rectangular box as such we can directly use a subdivided hyper rectangle mesh from the deal.II library. In this case, we have orientated the y-direction with gravity. As such, we have the long side of the box along this axis.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">grid</span> <span class="pre">arguments</span></code> is set to  <code class="docutils literal notranslate"><span class="pre">5,8,5:</span> <span class="pre">0,0,0</span> <span class="pre">:</span> <span class="pre">10</span> <span class="pre">,</span> <span class="pre">16</span> <span class="pre">,10</span> <span class="pre">:</span> <span class="pre">true</span></code>. This section has 3 subsections. First <code class="docutils literal notranslate"><span class="pre">5,8,5</span></code> describes the initial subdivision of the box. This subdivision has been chosen as it is the smallest mesh we can do of the box in order to have cubic elements. Secondly <code class="docutils literal notranslate"><span class="pre">0,0,0</span> <span class="pre">:</span> <span class="pre">10</span> <span class="pre">,</span> <span class="pre">16</span> <span class="pre">,10</span></code> describes the 2 points from which we have derived the rectangular box (0,0,0) and  (10,16,10). Finally, we have <code class="docutils literal notranslate"><span class="pre">true</span></code>, which is a boolean to activate the coloration of the boundary. This allows us to define separate boundary conditions at each side of the box.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">refinement</span></code> is set to 1. This will ensure to have a base mesh that is a bit smaller than the particle.</p></li>
</ul>
</section>
<section id="mesh-adaptation-control">
<h3><span class="section-number">2.4.5. </span>Mesh Adaptation Control<a class="headerlink" href="#mesh-adaptation-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh adaptation
   # Fraction of coarsened elements
  set fraction coarsening  = 0.3

  # Fraction of refined elements
  set fraction refinement  = 0.05

  # How the fraction of refinement/coarsening are interepretedChoices are
  # &lt;number|fraction&gt;.
  set fraction type        = number

  # Frequency of the mesh refinement
  set frequency            = 1

  # Maximum number of elements
  set max number elements  = 750000

  # Maximum refinement level
  set max refinement level = 6
 # minimum refinement level
  set min refinement level =0

  # Type of mesh adaptationChoices are &lt;none|uniform|kelly&gt;.
  set type                 = kelly

  # Variable for kelly estimationChoices are &lt;velocity|pressure&gt;.
  set variable             = velocity
end
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">fraction</span> <span class="pre">coarsening</span></code> is set to 0.3. This limits the accumulation of elements when the particle is moving. It allows for cells far from the particle to be coarsened when the particles get further away.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">fraction</span> <span class="pre">refinement</span></code> is set to 0.05. The objective here is to refine elements that become close to the particle when it’s moving. This will mostly refine elements around the particle that are not included in the refinement zone around the particle. The refinement zone around the particle will be discussed in more detail in the IB particle section.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">frequency</span></code> is set to 1. Since the particle is moving at each time step, the refinement zone around it should be reevaluated at each time step.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">refinement</span> <span class="pre">level</span></code> is set to 6. This parameter limits how small the elements around the particle can get limiting the total number of elements in the problem. Here we limit the mesh size to 48 elements per diameter of the particle. This should be sufficient to get accurate results.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> is set to <code class="docutils literal notranslate"><span class="pre">kelly</span></code>. Since the particle is moving and we do not want a uniform refinement of all the cells, we use the kelly error estimator based on the <code class="docutils literal notranslate"><span class="pre">velocity</span></code> variable.</p></li>
</ul>
</section>
<section id="boundary-conditions">
<h3><span class="section-number">2.4.6. </span>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection boundary conditions
set number                  = 5
    subsection bc 0
        set id = 0
        set type              = noslip
    end
    subsection bc 1
        set id = 1
        set type              = noslip
    end

    subsection bc 2
        set id = 2
        set type              = noslip
    end
    subsection bc 3
        set id = 4
        set type              = noslip
    end
    subsection bc 4
        set id = 5
        set type              = noslip
    end
end
</pre></div>
</div>
<p>Here we define the 5 <code class="docutils literal notranslate"><span class="pre">no</span> <span class="pre">slip</span></code> boundary for all the box walls and let the boundary with <code class="docutils literal notranslate"><span class="pre">id=3</span></code> free to represent the top of the box. We refer the reader to the <a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html"><span class="doc">Boundary conditions - CFD</span></a> section on how those boundaries are defined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The boundary id of dealii rectangular mesh are numbered as such:  <span class="math notranslate nohighlight">\(x_{min}=0\)</span>, <span class="math notranslate nohighlight">\(x_{max}=1\)</span>, <span class="math notranslate nohighlight">\(y_{min}=2\)</span>, <span class="math notranslate nohighlight">\(y_{max}=3\)</span>, <span class="math notranslate nohighlight">\(z_{min}=4\)</span>, <span class="math notranslate nohighlight">\(z_{max}=5\)</span>.</p>
</div>
</section>
<section id="initial-condition">
<h3><span class="section-number">2.4.7. </span>Initial condition<a class="headerlink" href="#initial-condition" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection initial conditions
  # Type of initial conditionChoices are &lt;L2projection|viscous|nodal&gt;.
    set type      = nodal
    subsection uvwp
            set Function expression = 0; 0; 0
    end
end
</pre></div>
</div>
<p>The initial condition for this case is simple to define. At the start of the simulation, we assume that the particle and the fluid are at rest. From there, we define a uniform velocity field of 0 everywhere. To do that, we used the <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">nodal</span></code> and then specified a function expression of 0 for all the velocity components.</p>
</section>
<section id="non-linear-solver-control">
<h3><span class="section-number">2.4.8. </span>Non-Linear Solver Control<a class="headerlink" href="#non-linear-solver-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection non-linear solver
  set verbosity               = verbose
  set tolerance               = 1e-6
  set max iterations          = 10
  set residual precision      = 5
  set force rhs calculation   = true
end
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> is set to 1e-6. This is small enough to ensure that the flow field is adequately resolved, as here, we expect a velocity of the particle of the order of 10.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">iterations</span></code> is set to 10. The objective here is to allow enough Newton non-linear steps to ensure the convergence to the tolerance. Also, we should limit the time pass on a single time step if the system is too stiff.</p></li>
<li><dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">force</span> <span class="pre">rhs</span> <span class="pre">calculation</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>. This is the most important modification with most of the other examples. By default, the non-linear solver will recalculate the RHS only after the update of the solution. But here, we need to evaluate it before every matrix resolution, and we cannot use the last RHS evaluation that was done after the last newton iteration. The particle position was updated between these two steps, changing the RHS evaluation. This means that for every non-linear step, we evaluate the RHS twice. The non-linear solver follows this sequence of steps for each newton iteration.</dt><dd><ul>
<li><p>update the particle position</p></li>
<li><p>update the Jacobian matrix</p></li>
<li><p>update the RHS</p></li>
<li><p>solve the matrix system</p></li>
<li><p>reevaluate the RHS to check the convergence.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="linear-solver-control">
<h3><span class="section-number">2.4.9. </span>Linear Solver Control<a class="headerlink" href="#linear-solver-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection linear solver
  set method                                 = gmres
  set max iters                              = 1000
  set max krylov vectors                     = 1000
  set relative residual                      = 1e-4
  set minimum residual                       = 1e-11
  set ilu preconditioner fill                = 0
  set ilu preconditioner absolute tolerance  = 1e-20
  set ilu preconditioner relative tolerance  = 1.00
  set verbosity                              = verbose
end
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">method</span></code> is set to <code class="docutils literal notranslate"><span class="pre">gmres</span></code>. This solver is less computationally expensive than the other option, and this case does not require any special preconditioner. This makes the <code class="docutils literal notranslate"><span class="pre">gmres</span></code> solver the best option available.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">iters</span></code> is set to 1000. This is a lot more steps than how much it should take to solve the system.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">max</span> <span class="pre">krylov</span> <span class="pre">vectors</span></code> is set to 1000. This is to ensure that we keep the full Arnoldi basis for each new iteration. From experience keeping a maximum of Krylov vector results in a faster resolution for this case than clearing the basis after a certain number of <code class="docutils literal notranslate"><span class="pre">gmres</span></code> iterations.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">relative</span> <span class="pre">residual</span></code> is set to 1e-4. This is small enough, so we don’t under-resolve our matrix and do extra non-linear steps because of it, and at the same, it doesn’t require too many <code class="docutils literal notranslate"><span class="pre">gmres</span></code> iterations.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ilu</span> <span class="pre">preconditioner</span> <span class="pre">fill</span></code> is set to 0. This means that we have a Jacobi preconditioner. This is the cheapest option. In this case, we are able to use this option without having to do too many <code class="docutils literal notranslate"><span class="pre">gmres</span></code> iterations. It requires less computational time to do a few more  <code class="docutils literal notranslate"><span class="pre">gmres</span></code> iterations than building the preconditioner and doing fewer <code class="docutils literal notranslate"><span class="pre">gmres</span></code> iterations.</p></li>
</ul>
</section>
<section id="ib-particles">
<h3><span class="section-number">2.4.10. </span>IB particles<a class="headerlink" href="#ib-particles" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection particles
    set number of particles = 1
    set stencil order =3
    set refine mesh inside radius factor = 0.8
    set refine mesh outside radius factor = 1.3
    set initial refinement = 6
    set integrate motion = true
    set assemble Navier-Stokes inside particles = false
    set length ratio = 2
    set particle nonlinear tolerance=1e-5
    set alpha =1
    subsection gravity
        set Function expression =0;-981;0
    end
    subsection particle info 0
        subsection position
            set Function expression =5;12.75;5
        end
        subsection velocity
            set Function expression =0;0;0
        end
        set type       = sphere
        set shape arguments = 0.75
        set density= 0.001120
    end
end
</pre></div>
</div>
<p>In this subsection, we define most of the parameters that are related to the particle.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">particles</span></code> is set to one as we only want one particle.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">stencil</span> <span class="pre">order</span></code> is set to 3 as this is the highest order we can use for this case, and it will not lead to Runge instability.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">refine</span> <span class="pre">mesh</span> <span class="pre">inside</span> <span class="pre">radius</span> <span class="pre">factor</span></code> is set to 0.8. This creates a mesh refinement around the particle that avoids having hanging nodes in the calculation and helps ensure a small enough mesh around the particle.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">refine</span> <span class="pre">mesh</span> <span class="pre">outside</span> <span class="pre">radius</span> <span class="pre">factor</span></code> is set to 1.3. This creates a mesh refinement around the particle that avoids having hanging nodes in the calculation and helps ensure a small enough mesh around the particle.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">initial</span> <span class="pre">refinement</span></code> is set to 6. Here we want to have the mesh as small as possible for the first time step. To achieve this, we refine every element with at least one vertex in the refinement zone around the particle 6 times before the simulation starts. This ensures that all the cells in the refinement zone around the particle is as small as possible. This number of refinement is 1 more than necessary. This is to avoid having part of the particle not properly refined as the initial mesh is big enough that some elements cut by the IB may not be properly detected at the beginning of the process. Doing one more refinement ensures that all the elements are properly refined.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">fluid</span> <span class="pre">density</span></code> is set to 0.000960 according to the description of the problem. As mentioned above, this parameter is a duplication of the density parameter in the physics properties. This will be changed soon, and this parameter will be removed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">integrate</span> <span class="pre">motion</span></code> is set to true because we are interested in the dynamic of the particle as it sediments in the rectangular box.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">assemble</span> <span class="pre">Navier-Stokes</span> <span class="pre">inside</span> <span class="pre">particles</span></code> is set to false because we are not interested in the flow inside of the particle.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">ratio</span></code> as been set to 2. This is small enough, so it does not impact too much the conditioning of the matrix while avoiding interpolation of the immersed boundary stencil in multiple elements.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">particle</span> <span class="pre">nonlinear</span> <span class="pre">tolerance</span></code> has been set to 1e-5. This is small enough to ensure that the particle dynamics are adequately resolved. We expect a velocity of the particle of the order of 10.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">gravity</span></code> <code class="docutils literal notranslate"><span class="pre">Function</span> <span class="pre">expression</span></code> is set to 0;-981;0 according to the definition of the case. As we choose the long axis of the rectangular box along the Y, we define gravity in this direction.</p></li>
</ul>
<p>The following parameters are defined in the particle subsection.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">position</span></code> Function expression is set to 5;12.75;5. This is the initial position of the particle according to the description of the case.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">velocity</span></code> Function expression is set to 0;0;0. This is the initial velocity of the particle since it starts at rest.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">radius</span></code> is set to 0.75. This is according to the definition of the case where the particle has a diameter of 1.5 cm.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">density</span></code> is set to 0.001120. This is according to the definition of the case.</p></li>
</ul>
</section>
</section>
<section id="results">
<h2><span class="section-number">2.5. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>In this section we will briefly show some results of this simulation.</p>
<p>First, we look at a slice of the velocity profile during the acceleration phase.</p>
<img alt="flow_field_acceleration" class="align-center" src="../../../_images/flow_field_acceleration.png"/>
<p>We can also compare the results obtained for the velocity in time with the results proposed by the article of Ten Cate <cite>et al.</cite> <a class="reference external" href="https://doi.org/10.1063/1.1512918">[1]</a></p>
<img alt="flow_field_acceleration" class="align-center" src="../../../_images/velocity_comparaison.png"/>
</section>
<section id="reference">
<h2><span class="section-number">2.6. </span>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://doi.org/10.1063/1.1512918">[1]</a> Ten Cate, A., Nieuwstad, C. H., Derksen, J. J., &amp; Van den Akker, H. E. A. (2002). Particle imaging velocimetry experiments and lattice-Boltzmann simulations on a single sphere settling under gravity. Physics of Fluids, 14(11), 4012-4025.`DOI &lt;<a class="reference external" href="https://doi.org/10.1063/1.1512918">https://doi.org/10.1063/1.1512918</a>&gt;`_</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../sphere-carreau-with-sharp-interface/sphere-carreau-with-sharp-interface.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">3. </span>Non-Newtonian flow past a sphere</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">1. </span>Flow around a cylinder using the sharp interface method</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../../_sources/examples/resolved_cfd-dem/sedimentation-1-particle/sedimentation-1-particle.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">2. Sedimentation of one particle.</a><ul>
<li><a class="reference internal" href="#features">2.1. Features</a></li>
<li><a class="reference internal" href="#description-of-the-case">2.2. Description of the case</a></li>
<li><a class="reference internal" href="#location-of-the-examples">2.3. Location of the examples</a></li>
<li><a class="reference internal" href="#parameter-file">2.4. Parameter file</a><ul>
<li><a class="reference internal" href="#simulation-and-io-control">2.4.1. Simulation and IO Control</a></li>
<li><a class="reference internal" href="#physical-properties">2.4.2. Physical Properties</a></li>
<li><a class="reference internal" href="#fem">2.4.3. FEM</a></li>
<li><a class="reference internal" href="#mesh">2.4.4. Mesh</a></li>
<li><a class="reference internal" href="#mesh-adaptation-control">2.4.5. Mesh Adaptation Control</a></li>
<li><a class="reference internal" href="#boundary-conditions">2.4.6. Boundary conditions</a></li>
<li><a class="reference internal" href="#initial-condition">2.4.7. Initial condition</a></li>
<li><a class="reference internal" href="#non-linear-solver-control">2.4.8. Non-Linear Solver Control</a></li>
<li><a class="reference internal" href="#linear-solver-control">2.4.9. Linear Solver Control</a></li>
<li><a class="reference internal" href="#ib-particles">2.4.10. IB particles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#results">2.5. Results</a></li>
<li><a class="reference internal" href="#reference">2.6. Reference</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>